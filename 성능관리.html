<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08. ì„±ëŠ¥ê´€ë¦¬ - ìƒì„¸ í•´ì„¤íŒ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #F8F9FA;
            --cell-bg: #FFFFFF;
            --code-bg: #F0F0F0;
            --border-color: #DADCE0;
            --accent-color: #1A73E8;
            --text-color: #202124;
        }

        body {
            font-family: 'Roboto', 'Noto Sans KR', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 40px;
        }

        .notebook-container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--cell-bg);
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            border-radius: 8px;
            padding: 40px;
        }

        /* ì…€ ìŠ¤íƒ€ì¼ */
        .cell { margin-bottom: 30px; }

        /* ë§ˆí¬ë‹¤ìš´ ì œëª© ìŠ¤íƒ€ì¼ */
        .markdown-cell h1 { border-bottom: 2px solid var(--border-color); padding-bottom: 10px; margin-top: 0; }
        .markdown-cell h2 { margin-top: 30px; color: #333; }
        .markdown-cell h3 { color: #555; }

        /* --- ìƒì„¸ ì„¤ëª… ë°•ìŠ¤ (íŠœí„° ë…¸íŠ¸) --- */
        .explanation-box {
            background-color: #e8f0fe; /* ì—°í•œ íŒŒë€ìƒ‰ ë°°ê²½ */
            border-left: 5px solid var(--accent-color);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 0 4px 4px 0;
            font-size: 0.95rem;
            color: #3c4043;
        }
        .explanation-box strong {
            color: #174ea6;
            font-weight: 700;
        }
        .explanation-box ul {
            margin: 5px 0 0 0;
            padding-left: 20px;
        }

        /* ì½”ë“œ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .code-wrapper {
            display: flex;
            align-items: flex-start;
        }
        .input-prompt {
            font-family: monospace;
            font-size: 12px;
            color: #9AA0A6;
            width: 50px;
            text-align: right;
            padding-right: 10px;
            padding-top: 10px;
            user-select: none;
        }
        .code-area {
            flex-grow: 1;
            background-color: var(--code-bg);
            border-radius: 4px;
            border: 1px solid var(--border-color);
            position: relative;
        }
        .code-area pre { margin: 0; padding: 12px; overflow-x: auto; }
        .code-area code { font-family: 'Consolas', monospace; font-size: 14px; background: transparent; }

        /* ì„¹ì…˜ êµ¬ë¶„ì„  */
        hr { border: 0; height: 1px; background: #eee; margin: 50px 0; }
    </style>
</head>
<body>

<div class="notebook-container">

    <div class="cell markdown-cell">
        <h1>ì„±ëŠ¥ê´€ë¦¬ - ì¼ë°˜í™” ì„±ëŠ¥, ë¯¸ë¦¬ ë©ˆì¶¤</h1>
        <p>ì´ ë…¸íŠ¸ë¶ì€ ëª¨ë¸ì´ ê³¼ì í•©(Overfitting)ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ <strong>Early Stopping(ì¡°ê¸° ì¢…ë£Œ)</strong>ê³¼ <strong>Model Checkpoint(ëª¨ë¸ ì €ì¥)</strong> ê¸°ìˆ ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
    </div>

    <div class="cell markdown-cell">
        <h2>1. í™˜ê²½ ì¤€ë¹„</h2>
        <h3>(1) ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”©</h3>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            ë°ì´í„° ë¶„ì„ê³¼ ë”¥ëŸ¬ë‹ ëª¨ë¸ë§ì— í•„ìš”í•œ í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.<br>
            <ul>
                <li><code>pandas, numpy</code>: ë°ì´í„° ì²˜ë¦¬ ë° ìˆ˜ì¹˜ ì—°ì‚°</li>
                <li><code>matplotlib, seaborn</code>: ë°ì´í„° ë° í•™ìŠµ ê²°ê³¼ ì‹œê°í™”</li>
                <li><code>sklearn</code>: ë°ì´í„°ì…‹ ë¶„í• , ì „ì²˜ë¦¬(ìŠ¤ì¼€ì¼ë§), ì„±ëŠ¥ í‰ê°€ ì§€í‘œ</li>
                <li><code>keras</code>: ë”¥ëŸ¬ë‹ ëª¨ë¸ ì„¤ê³„(Sequential), ë ˆì´ì–´ êµ¬ì„±(Dense), ìµœì í™”(Adam)</li>
            </ul>
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[1]</div>
            <div class="code-area">
<pre><code class="python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.model_selection import train_test_split
from sklearn.metrics import *
from sklearn.preprocessing import MinMaxScaler

from keras.models import Sequential
from keras.layers import Dense, Flatten, Input
from keras.backend import clear_session
from keras.optimizers import Adam
from keras.datasets import mnist</code></pre>
            </div>
        </div>
    </div>

    <div class="cell markdown-cell">
        <ul><li>í•¨ìˆ˜ ë§Œë“¤ê¸°</li></ul>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            ëª¨ë¸ í•™ìŠµ í›„ ê²°ê³¼ë¥¼ ê·¸ë˜í”„ë¡œ ê·¸ë ¤ì£¼ëŠ” <code>dl_history_plot</code> í•¨ìˆ˜ì…ë‹ˆë‹¤.<br>
            í•™ìŠµì´ ì§„í–‰ë¨ì— ë”°ë¼ <strong>Train Error(í•™ìŠµ ì˜¤ì°¨)</strong>ì™€ <strong>Validation Error(ê²€ì¦ ì˜¤ì°¨)</strong>ê°€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ ë¹„êµí•˜ì—¬ ê³¼ì í•© ì—¬ë¶€ë¥¼ íŒë‹¨í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[2]</div>
            <div class="code-area">
<pre><code class="python"># í•™ìŠµê³¡ì„  í•¨ìˆ˜
def dl_history_plot(history):
    plt.plot(history['loss'], label='train_err', marker = '.')
    plt.plot(history['val_loss'], label='val_err', marker = '.')

    plt.ylabel('Loss')
    plt.xlabel('Epoch')
    plt.legend()
    plt.grid()
    plt.show()</code></pre>
            </div>
        </div>
    </div>

    <div class="cell markdown-cell">
        <h3>(2) ë°ì´í„° ë¡œë”©</h3>
        <p>ê³¼ì í•©ì„ ìœ ë„í•˜ê¸° ìœ„í•´ íŠ¹ì„±(feature)ì´ ë§ì€ ì˜ˆì œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</p>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            GitHubì— ì €ì¥ëœ CSV íŒŒì¼ì„ <code>pandas</code>ë¥¼ ì´ìš©í•´ ì½ì–´ì˜µë‹ˆë‹¤.<br>
            <code>data.head()</code>ë¥¼ í†µí•´ ìƒìœ„ 5ê°œ í–‰ì„ ì¶œë ¥í•˜ì—¬ ë°ì´í„°ì˜ ìƒê¹€ìƒˆë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[3]</div>
            <div class="code-area">
<pre><code class="python">path = "https://raw.githubusercontent.com/DA4BAM/dataset/master/overfit_sample.csv"
data = pd.read_csv(path)
data.head()</code></pre>
            </div>
        </div>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            <code>data.shape</code>ë¡œ ë°ì´í„°ì˜ í¬ê¸°ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.<br>
            ì´ ë°ì´í„°ì…‹ì€ í–‰(ë°ì´í„° ìˆ˜)ì— ë¹„í•´ ì—´(íŠ¹ì„± ìˆ˜)ì´ ë§ì•„ ê³¼ì í•©ì´ ë°œìƒí•˜ê¸° ì‰¬ìš´ êµ¬ì¡°ì…ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[4]</div>
            <div class="code-area">
<pre><code class="python">data.shape</code></pre>
            </div>
        </div>
    </div>

    <hr>

    <div class="cell markdown-cell">
        <h2>2. Early Stopping (ì¡°ê¸° ì¢…ë£Œ)</h2>
        <h3>(1) ë°ì´í„° ì¤€ë¹„</h3>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            1. <strong>x, y ë¶„ë¦¬:</strong> <code>target</code> ì»¬ëŸ¼ì„ y(ì •ë‹µ)ë¡œ, ë‚˜ë¨¸ì§€ë¥¼ x(ì…ë ¥ ë°ì´í„°)ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤.<br>
            2. <strong>Train/Val ë¶„ë¦¬:</strong> í•™ìŠµìš© ë°ì´í„°(Train)ì™€ ê²€ì¦ìš© ë°ì´í„°(Validation)ë¥¼ 8:2 ë¹„ìœ¨ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤. ëª¨ë¸ì´ í•™ìŠµí•˜ì§€ ì•Šì€ ë°ì´í„°ì—ì„œë„ ì˜ ë§ì¶”ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[5]</div>
            <div class="code-area">
<pre><code class="python"># ë°ì´í„°ë¶„í•  : x, y
target = 'target'
x = data.drop(target, axis = 1)
y = data.loc[:, target]

# ë°ì´í„°ë¶„í•  : train, validation
x_train, x_val, y_train, y_val = train_test_split(x, y, test_size=.2, random_state = 20)</code></pre>
            </div>
        </div>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            <strong>ìŠ¤ì¼€ì¼ë§(MinMaxScaler):</strong> ëª¨ë“  ë°ì´í„° ê°’ì„ 0ê³¼ 1 ì‚¬ì´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.<br>
            ë”¥ëŸ¬ë‹ì—ì„œëŠ” ê°’ì˜ ë²”ìœ„ê°€ í¬ë©´ í•™ìŠµì´ ë¶ˆì•ˆì •í•´ì§€ë¯€ë¡œ ìŠ¤ì¼€ì¼ë§ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.<br>
            <em>ì£¼ì˜: train ë°ì´í„°ë¡œ fití•˜ê³ , ê·¸ ê¸°ì¤€ìœ¼ë¡œ val ë°ì´í„°ë¥¼ transform í•©ë‹ˆë‹¤.</em>
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[6]</div>
            <div class="code-area">
<pre><code class="python"># ìŠ¤ì¼€ì¼ë§
scaler = MinMaxScaler()
x_train = scaler.fit_transform(x_train)
x_val = scaler.transform(x_val)</code></pre>
            </div>
        </div>
    </div>

    <div class="cell markdown-cell">
        <h3>(2) ëª¨ë¸ë§ (ê¸°ë³¸ í•™ìŠµ)</h3>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.<br>
            <ul>
                <li><code>Input</code>: ì…ë ¥ ë°ì´í„°ì˜ íŠ¹ì„± ê°œìˆ˜(nfeatures)ë§Œí¼ ì…ë ¥ì„ ë°›ìŠµë‹ˆë‹¤.</li>
                <li><code>Dense</code>: ì™„ì „ ì—°ê²° ë ˆì´ì–´(Fully Connected Layer)ì…ë‹ˆë‹¤.</li>
                <li><code>activation='sigmoid'</code>: ì´ì§„ ë¶„ë¥˜(0ì´ëƒ 1ì´ëƒ) ë¬¸ì œì´ë¯€ë¡œ ë§ˆì§€ë§‰ ì¸µì€ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
                <li><code>compile</code>: í•™ìŠµ ë°©ë²•(Optimizer: Adam)ê³¼ ì˜¤ì°¨ ê³„ì‚°ë²•(Loss: binary_crossentropy)ì„ ì„¤ì •í•©ë‹ˆë‹¤.</li>
            </ul>
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[7]</div>
            <div class="code-area">
<pre><code class="python"># input_shape : feature ìˆ˜ ë„ì¶œ
nfeatures = x_train.shape[1]

# ë©”ëª¨ë¦¬ ì •ë¦¬
clear_session()

# Sequential íƒ€ì…
model1 = Sequential( [Input(shape = (nfeatures,)),
                      Dense(128, activation= 'relu'),
                      Dense(64, activation= 'relu'),
                      Dense(32, activation= 'relu'),
                      Dense(1, activation= 'sigmoid')] )

# ì»´íŒŒì¼
model1.compile(optimizer= Adam(learning_rate = 0.001), loss='binary_crossentropy')</code></pre>
            </div>
        </div>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            ëª¨ë¸ì„ 100ë²ˆ(epochs=100) ë°˜ë³µ í•™ìŠµì‹œí‚µë‹ˆë‹¤.<br>
            ì´ë•Œ ì¡°ê¸° ì¢…ë£Œ(Early Stopping)ê°€ ì—†ìœ¼ë¯€ë¡œ, ê³¼ì í•©ì´ ë°œìƒí•˜ë”ë¼ë„ 100ë²ˆì„ ëê¹Œì§€ ì±„ìš°ê²Œ ë©ë‹ˆë‹¤.<br>
            ê·¸ë˜í”„ë¥¼ í™•ì¸í•´ë³´ë©´ <strong>Val Lossê°€ ì¤„ì–´ë“¤ë‹¤ê°€ ë‹¤ì‹œ íŠ€ì–´ ì˜¤ë¥´ëŠ”(ê³¼ì í•©)</strong> ì§€ì ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[8]</div>
            <div class="code-area">
<pre><code class="python"># í•™ìŠµ
hist = model1.fit(x_train, y_train, epochs = 100, validation_split=0.2, verbose = 0).history

# í•™ìŠµê²°ê³¼ ê·¸ë˜í”„
dl_history_plot(hist)</code></pre>
            </div>
        </div>
    </div>

    <div class="cell markdown-cell">
        <h3>(3) ë¯¸ë¦¬ ë©ˆì¶¤! (Early Stopping)</h3>
        <h4>1) í•¨ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°</h4>
    </div>

    <div class="cell">
        <div class="code-wrapper">
            <div class="input-prompt">[9]</div>
            <div class="code-area">
<pre><code class="python">from keras.callbacks import EarlyStopping</code></pre>
            </div>
        </div>
    </div>

    <div class="cell markdown-cell">
        <h4>2) ëª¨ë¸ë§ with Early Stopping</h4>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            <strong>EarlyStopping ì„¤ì •:</strong>
            <ul>
                <li><code>monitor='val_loss'</code>: ê²€ì¦ ë°ì´í„°ì˜ ì˜¤ì°¨(val_loss)ë¥¼ ê°ì‹œí•©ë‹ˆë‹¤.</li>
                <li><code>min_delta</code>: ì˜¤ì°¨ê°€ ì´ ê°’ë³´ë‹¤ ì ê²Œ ì¤„ì–´ë“¤ë©´ ê°œì„ ë˜ì§€ ì•Šì€ ê²ƒìœ¼ë¡œ ë´…ë‹ˆë‹¤.</li>
                <li><code>patience=5</code>: ì˜¤ì°¨ê°€ ê°œì„ ë˜ì§€ ì•Šì•„ë„ 5ë²ˆ(epoch)ê¹Œì§€ëŠ” ì°¸ìŠµë‹ˆë‹¤. ê·¸ë˜ë„ ê°œì„ ì´ ì—†ìœ¼ë©´ í•™ìŠµì„ ë©ˆì¶¥ë‹ˆë‹¤.</li>
            </ul>
            <code>callbacks=[es]</code>ë¥¼ <code>.fit()</code> ì•ˆì— ë„£ì–´ì£¼ë©´ ì„¤ì •ì´ ì ìš©ë©ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[10]</div>
            <div class="code-area">
<pre><code class="python"># ëª¨ë¸ ì„ ì–¸ (ì´ˆê¸°í™”)
clear_session()

model2 = Sequential( [Input(shape = (nfeatures,)),
                      Dense(128, activation= 'relu'),
                      Dense(64, activation= 'relu'),
                      Dense(32, activation= 'relu'),
                      Dense(1, activation= 'sigmoid')] )
model2.compile(optimizer= Adam(learning_rate = 0.001), loss='binary_crossentropy')

# EarlyStopping ì„¤ì • ------------
min_de = 0.001
pat = 5

es = EarlyStopping(monitor = 'val_loss', min_delta = min_de, patience = pat)
# --------------------------------

# í•™ìŠµ (callbacks ì˜µì…˜ ì¶”ê°€)
hist = model2.fit(x_train, y_train, epochs = 100, validation_split=0.2,
                  callbacks = [es]).history
dl_history_plot(hist)</code></pre>
            </div>
        </div>
    </div>

    <hr>

    <div class="cell markdown-cell">
        <h2>3. ëª¨ë¸ ì €ì¥í•˜ê¸°</h2>
        <h3>(1) ëª¨ë¸ ì €ì¥í•˜ê¸° ë° ë¡œë”©í•˜ê¸°</h3>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            <code>model.save()</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ëª¨ë¸ì˜ êµ¬ì¡°ì™€ í•™ìŠµëœ ê°€ì¤‘ì¹˜(weight)ë¥¼ íŒŒì¼(.keras)ë¡œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
            ì´í›„ <code>load_model()</code>ë¡œ ì–¸ì œë“ ì§€ ë‹¤ì‹œ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[11]</div>
            <div class="code-area">
<pre><code class="python"># ëª¨ë¸ ì €ì¥
model1.save('hanky.keras')

# ëª¨ë¸ ë¡œë”©
from keras.models import load_model
model2 = load_model('hanky.keras')</code></pre>
            </div>
        </div>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            ë¶ˆëŸ¬ì˜¨ ëª¨ë¸ë¡œ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ê³  ì„±ëŠ¥ì„ í‰ê°€í•©ë‹ˆë‹¤.<br>
            <code>np.where(pred2 > 0.5, 1, 0)</code>: ì‹œê·¸ëª¨ì´ë“œ ì¶œë ¥ê°’(0~1 í™•ë¥ )ì„ 0.5 ê¸°ì¤€ìœ¼ë¡œ 0 ë˜ëŠ” 1ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[12]</div>
            <div class="code-area">
<pre><code class="python">pred2 = model2.predict(x_val)
pred2_1 = np.where(pred2 > .5, 1, 0)

print(accuracy_score(y_val, pred2_1))
print('-'*60)
print(classification_report(y_val, pred2_1))</code></pre>
            </div>
        </div>
    </div>

    <div class="cell markdown-cell">
        <h3>(3) ì¤‘ê°„ ì²´í¬í¬ì¸íŠ¸ ì €ì¥ (ModelCheckpoint)</h3>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            ì‹¤ìŠµì„ ìœ„í•´ ê¸°ì¡´ì— ì €ì¥ëœ ëª¨ë¸ íŒŒì¼ë“¤ì„ ì‚­ì œí•˜ëŠ” ìœ í‹¸ë¦¬í‹° ì½”ë“œì…ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[13]</div>
            <div class="code-area">
<pre><code class="python">import os

def delete_model_files(directory):
    for filename in os.listdir(directory):
        if filename.endswith(".keras"):
            os.remove(os.path.join(directory, filename))
            print(f"Deleted: {filename}")

delete_model_files("/content/")</code></pre>
            </div>
        </div>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            <strong>ModelCheckpoint:</strong> í•™ìŠµ ë„ì¤‘ ì„±ëŠ¥ì´ ì¢‹ì„ ë•Œë§ˆë‹¤ ëª¨ë¸ì„ ìë™ìœ¼ë¡œ ì €ì¥í•´ì£¼ëŠ” ì½œë°±í•¨ìˆ˜ì…ë‹ˆë‹¤.<br>
            EarlyStoppingì€ ë©ˆì¶”ëŠ” ê¸°ëŠ¥ë§Œ ìˆì§€ë§Œ, ì´ê±´ <strong>"ê°€ì¥ ì¢‹ì•˜ë˜ ìˆœê°„"</strong>ì„ íŒŒì¼ë¡œ ë‚¨ê¹ë‹ˆë‹¤.<br>
            <ul>
                <li><code>save_best_only=True</code>: ì´ì „ë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ì•„ì¡Œì„ ë•Œë§Œ ì €ì¥í•©ë‹ˆë‹¤. (ìš©ëŸ‰ ì ˆì•½)</li>
                <li><code>verbose=1</code>: ì €ì¥í•  ë•Œë§ˆë‹¤ "ì €ì¥í–ˆìŠµë‹ˆë‹¤!"ë¼ê³  ë©”ì‹œì§€ë¥¼ ë„ì›ë‹ˆë‹¤.</li>
            </ul>
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[14]</div>
            <div class="code-area">
<pre><code class="python">from keras.callbacks import ModelCheckpoint

# ëª¨ë¸ ì´ˆê¸°í™”
clear_session()
model1 = Sequential( [Input(shape = (nfeatures,)),
                      Dense(64, activation= 'relu'),
                      Dense(32, activation= 'relu'),
                      Dense(16, activation= 'relu'),
                      Dense(1, activation= 'sigmoid')] )
model1.compile(optimizer= Adam(learning_rate = 0.0001), loss='binary_crossentropy')

# ì²´í¬í¬ì¸íŠ¸ ì„¤ì •: ì—í¬í¬ ë²ˆí˜¸ë¥¼ íŒŒì¼ëª…ì— í¬í•¨
cp_path = '/content/{epoch:03d}.keras'
mcp = ModelCheckpoint(cp_path, monitor='val_loss', verbose = 1, save_best_only=True)

# í•™ìŠµ
hist = model1.fit(x_train, y_train, epochs = 50, validation_split=.2, callbacks=[mcp]).history
dl_history_plot(hist)</code></pre>
            </div>
        </div>
    </div>

    <div class="cell markdown-cell">
        <h4>3) ìµœì¢… Best ëª¨ë¸ë§Œ ì €ì¥í•˜ê¸°</h4>
    </div>

    <div class="cell">
        <div class="explanation-box">
            <strong>ğŸ’¡ ìƒì„¸ ì„¤ëª…:</strong><br>
            ë§¤ë²ˆ ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, <code>best_model.keras</code>ë¼ëŠ” <strong>í•˜ë‚˜ì˜ íŒŒì¼ì— ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ì€ ëª¨ë¸ë§Œ ë®ì–´ì“°ê¸°</strong> í•©ë‹ˆë‹¤.<br>
            í•™ìŠµì´ ëë‚˜ë©´ ì´ íŒŒì¼ì—ëŠ” "ì „ì²´ ê³¼ì • ì¤‘ ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ì•˜ë˜ ëª¨ë¸"ì´ ë“¤ì–´ìˆê²Œ ë©ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[15]</div>
            <div class="code-area">
<pre><code class="python"># ëª¨ë¸ ì´ˆê¸°í™” ë° ì»´íŒŒì¼ (ìƒëµ)
# ...

cp_path = '/content/best_model.keras'
mcp = ModelCheckpoint(cp_path, monitor='val_loss', verbose = 1, save_best_only=True)

# í•™ìŠµ
hist = model1.fit(x_train, y_train, epochs = 50, validation_split=.2, callbacks=[mcp]).history</code></pre>
            </div>
        </div>
    </div>

    <hr>

    <div class="cell markdown-cell">
        <h2>4. ë³µìŠµ ë¬¸ì œ (ì™„ì„±ë³¸)</h2>
        <p><strong>ë¯¸ë¦¬ ë©ˆì¶¤(Early Stopping)</strong>ê³¼ <strong>ë² ìŠ¤íŠ¸ ëª¨ë¸ ì €ì¥(Model Checkpoint)</strong>ì„ ë™ì‹œì— ì ìš©í•´ë´…ì‹œë‹¤.</p>
    </div>

    <div class="cell">
        <div class="code-wrapper">
            <div class="input-prompt">[16]</div>
            <div class="code-area">
<pre><code class="python"># ëª¨ë¸ ì •ì˜ ë° ì»´íŒŒì¼
clear_session()
model3 = Sequential( [Input(shape = (nfeatures,)),
                      Dense(64, activation= 'relu'),
                      Dense(32, activation= 'relu'),
                      Dense(16, activation= 'relu'),
                      Dense(1, activation= 'sigmoid')] )

model3.compile(optimizer= Adam(learning_rate = 0.0001), loss='binary_crossentropy')</code></pre>
            </div>
        </div>
    </div>

    <div class="cell">
        <div class="explanation-box" style="border-left-color: #34a853; background-color: #e6f4ea;">
            <strong>âœ… ì •ë‹µ ì„¤ëª…:</strong><br>
            ì‹¤ë¬´ì—ì„œ ê°€ì¥ ë§ì´ ì“°ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.<br>
            1. <code>EarlyStopping</code>ìœ¼ë¡œ ê³¼ì í•©ì´ ì‹œì‘ë˜ë©´ í•™ìŠµì„ ë©ˆì¶¥ë‹ˆë‹¤. (ì‹œê°„ ì ˆì•½)<br>
            2. <code>ModelCheckpoint</code>ë¡œ ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ì•˜ë˜ ìˆœê°„ì˜ ëª¨ë¸ì„ ì €ì¥í•´ë‘¡ë‹ˆë‹¤. (ì„±ëŠ¥ ë³´ì¥)<br>
            3. <code>callbacks=[es, mcp]</code> ì²˜ëŸ¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë¬¶ì–´ì„œ ì „ë‹¬í•˜ë©´ ë‘ ê¸°ëŠ¥ì´ ë™ì‹œì— ì‘ë™í•©ë‹ˆë‹¤.
        </div>
        <div class="code-wrapper">
            <div class="input-prompt">[17]</div>
            <div class="code-area">
<pre><code class="python"># 1. EarlyStopping ì„¤ì • (ê¸°ë‹¤ë¦¬ëŠ” íšŸìˆ˜ 5íšŒ)
min_de = 0.001
pat = 5
es = EarlyStopping(monitor = 'val_loss', min_delta = min_de, patience = pat)

# 2. ModelCheckpoint ì„¤ì • (best_model.keras íŒŒì¼ì— ìµœê³  ì„±ëŠ¥ ëª¨ë¸ë§Œ ì €ì¥)
cp_path = '/content/best_model.keras'
mcp = ModelCheckpoint(cp_path, monitor='val_loss', verbose = 1, save_best_only=True)

# 3. í•™ìŠµ ì‹¤í–‰ (ë‘ ì½œë°±ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ì „ë‹¬)
hist = model3.fit(x_train, y_train, epochs = 100, validation_split=0.2, 
                  callbacks = [es, mcp]).history

dl_history_plot(hist)</code></pre>
            </div>
        </div>
    </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

</body>
</html>