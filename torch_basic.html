<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyTorch Interactive Tutorial</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Pretendard:wght@300;400;500;600;700;800&display=swap');

        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #f8fafc;
            color: #334155;
            scroll-behavior: smooth;
        }

        h1, h2, h3 { letter-spacing: -0.02em; }
        code { font-family: 'JetBrains Mono', monospace; font-size: 0.9em; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Sidebar Styling */
        .sidebar-item {
            position: relative;
            transition: all 0.2s ease;
            border-radius: 0.5rem;
            margin-bottom: 0.25rem;
        }
        .sidebar-item:hover {
            background-color: #f1f5f9;
            transform: translateX(4px);
        }
        .sidebar-item.active {
            background-color: #eff6ff;
            color: #2563eb;
            font-weight: 600;
        }
        .sidebar-item.active::before {
            content: '';
            position: absolute;
            left: -1rem; /* Adjust based on padding */
            top: 10%;
            height: 80%;
            width: 4px;
            background: linear-gradient(to bottom, #3b82f6, #06b6d4);
            border-radius: 0 4px 4px 0;
        }

        /* Card Styling */
        .code-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .code-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            transform: translateY(-2px);
            border-color: #cbd5e1;
        }

        /* Output Animation Styling */
        .output-block {
            background-color: #f8fafc;
            color: #475569;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            border-top: 1px solid #e2e8f0;
            min-height: 2.5rem; /* Prevent layout shift */
        }

        /* Typing Cursor */
        .typing::after {
            content: '▋';
            display: inline-block;
            color: #3b82f6;
            animation: blink 1s step-end infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* Gradient Text */
        .text-gradient {
            background: linear-gradient(to right, #2563eb, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Execution Counter Styling */
        .exec-count {
            color: #ef4444; /* Red for In [ ] */
            font-family: 'JetBrains Mono', monospace;
            font-weight: bold;
            font-size: 0.75rem;
        }
    </style>
</head>
<body class="antialiased h-screen flex overflow-hidden text-slate-700 bg-slate-50">

    <!-- Sidebar Navigation -->
    <nav class="w-72 flex-shrink-0 bg-white border-r border-slate-200 flex flex-col hidden lg:flex shadow-sm z-20">
        <div class="p-8 border-b border-slate-100">
            <h1 class="text-3xl font-extrabold tracking-tight">
                <span class="text-gradient">PyTorch</span><br>
                <span class="text-slate-700 text-2xl">Tutorial</span>
            </h1>
            <p class="text-xs text-slate-400 mt-2 font-medium uppercase tracking-widest">Interactive Notebook</p>
        </div>
        <div class="flex-1 overflow-y-auto p-6 space-y-1" id="toc">
            <!-- TOC generated by JS -->
        </div>
        <div class="p-4 border-t border-slate-100 text-center">
            <a href="#" class="text-xs text-slate-400 hover:text-blue-500 transition font-medium flex justify-center items-center gap-2">
                <i class="fa-solid fa-arrow-up"></i> Top of Page
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto relative scroll-smooth bg-slate-50" id="main-content">
        <div class="max-w-4xl mx-auto p-6 md:p-16 space-y-24">

            <!-- Intro Header -->
            <div class="text-center space-y-4 mb-16">
                <span class="inline-block py-1 px-3 rounded-full bg-blue-100 text-blue-600 text-xs font-bold tracking-wide uppercase">Deep Learning Basics</span>
                <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900">PyTorch 기초 완벽 가이드</h1>
                <p class="text-lg text-slate-600 max-w-2xl mx-auto">
                    Numpy와 유사한 문법으로 시작하는 딥러닝 입문.<br>
                    <span class="text-blue-500 font-semibold">▶ Run</span> 버튼을 눌러 코드를 실행해보세요!
                </p>
            </div>

            <!-- Section 1: Basics -->
            <section id="sec-basics" class="scroll-mt-10">
                <div class="mb-8 pl-4 border-l-4 border-blue-500">
                    <h2 class="text-3xl font-bold text-slate-900">01. Tensor의 기초</h2>
                    <p class="text-slate-500 mt-1">텐서를 생성하고 속성을 확인하는 기본기입니다.</p>
                </div>

                <!-- Code Cell 1 -->
                <div class="mb-12">
                    <div class="explanation-text mb-3 text-slate-700">
                        <i class="fa-regular fa-lightbulb text-amber-400 mr-2"></i>
                        파이썬 리스트를 <code>torch.tensor()</code>에 넣어 텐서를 만듭니다.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                            <span class="exec-count">In [1]:</span>
                            <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">import torch
a=torch.tensor([1,2,3,4])
print(a)
print(type(a))
print(a.dtype) # data type
print(a.shape)
b=torch.tensor([1,2,3.1,4])
print(b.dtype) # 자동 casting
print(b)</code></pre>
                        <div class="output-container relative">
                            <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [1]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([1, 2, 3, 4])
<class 'torch.Tensor'>
torch.int64
torch.Size([4])
torch.float32
tensor([1.0000, 2.0000, 3.1000, 4.0000])"></div>
                        </div>
                    </div>
                </div>

                <!-- Code Cell 2 -->
                <div class="mb-12">
                    <div class="explanation-text mb-3 text-slate-700">
                         <i class="fa-regular fa-lightbulb text-amber-400 mr-2"></i>
                        <strong>행렬(Matrix)</strong>은 2차원 텐서입니다. `shape`와 `ndim`을 확인해보세요.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                            <span class="exec-count">In [2]:</span>
                            <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">A=torch.tensor([[1,2,3],[3,4,5]])
# 각 행의 원소 개수는 같아야 합니다.
print(A)
print(A.shape)
print(A.ndim) # 차원의 수
print(A.numel()) # 전체 성분의 수</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [2]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([[1, 2, 3],
        [3, 4, 5]])
torch.Size([2, 3])
2
6"></div>
                        </div>
                    </div>
                </div>

                 <!-- Code Cell 3 -->
                <div class="mb-12">
                    <div class="explanation-text mb-3 text-slate-700">
                        <i class="fa-solid fa-wand-magic-sparkles text-purple-400 mr-2"></i>
                        0으로 채우기(`zeros`), 1로 채우기(`ones`) 등 편리한 초기화 함수들입니다.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                            <span class="exec-count">In [3]:</span>
                            <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">print(torch.zeros(5))
print(torch.zeros_like(A))
print(torch.ones(5))
print(torch.zeros( 3,3 ) )
print(torch.arange(3,10,2))
print(torch.arange(0,1,0.1))
print(torch.linspace(0,1,10))</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [3]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([0., 0., 0., 0., 0.])
tensor([[0, 0, 0],
        [0, 0, 0]])
tensor([1., 1., 1., 1., 1.])
tensor([[0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.]])
tensor([3, 5, 7, 9])
tensor([0.0000, 0.1000, 0.2000, 0.3000, 0.4000, 0.5000, 0.6000, 0.7000, 0.8000,
        0.9000])
tensor([0.0000, 0.1111, 0.2222, 0.3333, 0.4444, 0.5556, 0.6667, 0.7778, 0.8889,
        1.0000])"></div>
                        </div>
                    </div>
                </div>

                 <!-- Code Cell 6 (MatMul) -->
                <div class="mb-12">
                    <div class="explanation-text mb-3 text-slate-700">
                         <i class="fa-solid fa-calculator text-blue-400 mr-2"></i>
                        가장 중요한 <strong>행렬 곱(Matrix Multiplication)</strong>은 `@` 연산자를 사용합니다. `*`는 원소끼리 곱하기입니다.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                            <span class="exec-count">In [6]:</span>
                            <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">A=torch.tensor([[1,2],[3,4]])
B=torch.tensor([[1,2],[3,4]])

print(A*B) # 원소별 곱 (Element-wise)
print(A@B) # 행렬 곱 (Dot Product)</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [6]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([[ 1,  4],
        [ 9, 16]])
tensor([[ 7, 10],
        [15, 22]])"></div>
                        </div>
                    </div>
                </div>
            </section>


            <!-- Section 2: Indexing -->
            <section id="sec-indexing" class="scroll-mt-10">
                <div class="mb-8 pl-4 border-l-4 border-emerald-500">
                    <h2 class="text-3xl font-bold text-slate-900">02. 인덱싱과 슬라이싱</h2>
                    <p class="text-slate-500 mt-1">데이터의 원하는 부분만 쏙쏙 뽑아내는 방법입니다.</p>
                </div>

                <div class="mb-12">
                     <div class="explanation-text mb-3 text-slate-700">
                        <i class="fa-solid fa-scissors text-emerald-400 mr-2"></i>
                        리스트처럼 <code>[start:end]</code>로 자를 수 있습니다.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                            <span class="exec-count">In [7]:</span>
                            <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">a=torch.tensor([1,2,3,4,5,6,7,8,9])
print(a[0])
print(a[1:4])
print(a[7:])</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [7]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor(1)
tensor([2, 3, 4])
tensor([8, 9])"></div>
                        </div>
                    </div>
                </div>

                <div class="mb-12">
                     <div class="explanation-text mb-3 text-slate-700">
                        <i class="fa-solid fa-table-cells text-emerald-400 mr-2"></i>
                        <strong>Boolean Indexing (마스킹)</strong>: 조건(`A > 3`)에 맞는 값만 골라낼 수 있습니다. 아주 강력합니다!
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                             <span class="exec-count">In [11]:</span>
                             <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">A=torch.tensor([[1,2,3,4],[5,3,7,3]])
print(A>3) # 조건 검사
print(A[A>3]) # True인 값만 추출

A[A>3] = 100 # 조건에 맞는 값 변경
print(A)</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [11]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([[False, False, False,  True],
        [ True, False,  True, False]])
tensor([4, 5, 7])
tensor([[  1,   2,   3, 100],
        [100,   3, 100,   3]])"></div>
                        </div>
                    </div>
                </div>
            </section>

             <!-- Section 4: Shape -->
            <section id="sec-shape" class="scroll-mt-10">
                <div class="mb-8 pl-4 border-l-4 border-orange-500">
                    <h2 class="text-3xl font-bold text-slate-900">03. 모양 바꾸기 (Reshape)</h2>
                    <p class="text-slate-500 mt-1">차원을 자유자재로 다루는 기술입니다.</p>
                </div>

                 <div class="mb-12">
                     <div class="explanation-text mb-3 text-slate-700">
                        <i class="fa-solid fa-shapes text-orange-400 mr-2"></i>
                        <code>reshape</code>을 사용합니다. <code>-1</code>을 넣으면 남은 차원을 자동으로 계산해줍니다.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                            <span class="exec-count">In [24]:</span>
                             <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">A=torch.arange(20)
print(A)
print(A.reshape(4,5))
print(A.reshape(4,-1).shape) # 4행, 열은 알아서(5)
print(A.reshape(2,5,-1).shape) # 3차원 변환</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [24]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19])
tensor([[ 0,  1,  2,  3,  4],
        [ 5,  6,  7,  8,  9],
        [10, 11, 12, 13, 14],
        [15, 16, 17, 18, 19]])
torch.Size([4, 5])
torch.Size([2, 5, 2])"></div>
                        </div>
                    </div>
                </div>
            </section>

             <!-- Section 6: Autograd -->
            <section id="sec-autograd" class="scroll-mt-10">
                <div class="mb-8 pl-4 border-l-4 border-red-500">
                    <h2 class="text-3xl font-bold text-slate-900">04. 자동 미분 (Autograd)</h2>
                    <p class="text-slate-500 mt-1">딥러닝의 핵심! 미분을 자동으로 계산해줍니다.</p>
                </div>

                 <div class="mb-12">
                     <div class="explanation-text mb-3 text-slate-700">
                        <i class="fa-solid fa-calculator text-red-400 mr-2"></i>
                        <code>requires_grad=True</code>로 설정하면 텐서의 모든 연산 기록을 추적합니다. <code>backward()</code>를 호출하면 미분값이 <code>.grad</code>에 저장됩니다.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                            <span class="exec-count">In [39]:</span>
                             <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">x=torch.tensor([1.],requires_grad=True)
y=x**2 # y = x^2
print(y)

y.backward() # 미분 실행! (dy/dx = 2x)
print(x.grad) # x=1일 때 미분값은 2</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [39]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([1.], grad_fn=<PowBackward0>)
tensor([2.])"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 7: Neural Network -->
            <section id="sec-nn" class="scroll-mt-10 mb-32">
                 <div class="mb-8 pl-4 border-l-4 border-pink-500">
                    <h2 class="text-3xl font-bold text-slate-900">05. 인공신경망 만들기</h2>
                    <p class="text-slate-500 mt-1">nn.Linear와 Class를 이용한 모델 정의</p>
                </div>

                 <div class="mb-12">
                     <div class="explanation-text mb-3 text-slate-700">
                        <i class="fa-solid fa-network-wired text-pink-400 mr-2"></i>
                        <strong>나만의 모델 클래스</strong>를 만드는 정석적인 방법입니다.
                    </div>
                    <div class="code-card group">
                        <div class="code-header px-4 py-3 flex justify-between items-center bg-slate-50 border-b border-slate-100">
                             <span class="exec-count">In [62]:</span>
                             <div class="flex gap-3">
                                <button class="text-xs text-slate-400 hover:text-blue-600 font-bold transition flex items-center gap-1" onclick="runCode(this)">
                                    <i class="fa-solid fa-play"></i> Run
                                </button>
                                <button class="text-xs text-slate-400 hover:text-slate-600 font-medium transition" onclick="copyCode(this)">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <pre class="m-0"><code class="python p-6">from torch import nn

class MyModel(nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = nn.Linear(2,5)
        self.act = nn.Sigmoid()
        self.fc2 = nn.Linear(5,1)

    def forward(self, x):
        x = self.fc1(x)
        x = self.act(x)
        x = self.fc2(x)
        return x

model = MyModel()
x = torch.randn(5,2)
y = model(x)
print(y)</code></pre>
                        <div class="output-container relative">
                             <div class="absolute top-0 left-0 px-2 py-1 bg-slate-100 text-slate-400 text-[10px] font-mono border-r border-b border-slate-200 rounded-br">Out [62]</div>
                            <div class="output-block p-6 pt-8" data-output="tensor([[-0.1234],
        [ 0.2341],
        [-0.0012],
        [ 0.5678],
        [-0.9999]], grad_fn=<AddmmBackward0>)"></div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <script>
        // Init Highlight.js
        hljs.highlightAll();

        // 1. Generate Table of Contents (Sidebar)
        const sections = document.querySelectorAll('section');
        const tocContainer = document.getElementById('toc');
        const mainContent = document.getElementById('main-content');

        sections.forEach(section => {
            const h2 = section.querySelector('h2');
            if (h2) {
                const title = h2.innerText;
                const link = document.createElement('a');
                link.href = '#' + section.id;
                link.innerHTML = `<span class="truncate">${title}</span>`;
                link.className = 'sidebar-item block px-4 py-3 text-sm text-slate-500 font-medium cursor-pointer';
                link.onclick = (e) => {
                    e.preventDefault();
                    section.scrollIntoView();
                };
                tocContainer.appendChild(link);
            }
        });

        // 2. Active Link Highlighter using Intersection Observer
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    document.querySelectorAll('.sidebar-item').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === '#' + id) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        }, { root: mainContent, threshold: 0.2 });
        sections.forEach(section => observer.observe(section));

        // 3. Typewriter Effect Logic
        function typeWriter(element, text, speed = 5) {
            element.innerHTML = ''; // Clear existing
            element.classList.add('typing'); // Add cursor
            
            let i = 0;
            // Use requestAnimationFrame for smoother performance or simple interval
            // Fast typing logic: Type chunks of characters to mimic terminal speed
            const type = () => {
                if (i < text.length) {
                    // Type 2-5 chars at once for speed variation (feels more natural/fast)
                    const chunk = Math.floor(Math.random() * 5) + 2; 
                    element.textContent += text.substring(i, i + chunk);
                    i += chunk;
                    
                    // Auto scroll to bottom of code block if it gets too long
                    // element.scrollTop = element.scrollHeight; 
                    
                    setTimeout(type, speed);
                } else {
                    element.classList.remove('typing'); // Remove cursor
                }
            };
            type();
        }

        // 4. Trigger Typewriter on Scroll
        const outputObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const block = entry.target;
                    // Only type if not already typed
                    if (!block.dataset.typed) {
                        const text = block.dataset.output;
                        typeWriter(block, text, 10); // 10ms speed
                        block.dataset.typed = "true";
                    }
                }
            });
        }, { root: mainContent, threshold: 0.2 });

        document.querySelectorAll('.output-block').forEach(block => {
            outputObserver.observe(block);
        });

        // 5. Run Button Logic (Re-trigger animation)
        function runCode(btn) {
            const card = btn.closest('.code-card');
            const outputBlock = card.querySelector('.output-block');
            const text = outputBlock.dataset.output;
            
            // Visual feedback on button
            const originalIcon = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Running';
            btn.classList.add('text-blue-600');
            
            // Clear and Restart Typing
            outputBlock.innerHTML = '';
            outputBlock.dataset.typed = "false"; // Reset flag
            
            setTimeout(() => {
                typeWriter(outputBlock, text, 5); // Faster re-run
                btn.innerHTML = originalIcon;
                btn.classList.remove('text-blue-600');
            }, 500); // Simulate tiny delay
        }

        // 6. Copy Code Logic
        function copyCode(btn) {
            const codeBlock = btn.closest('.code-card').querySelector('code');
            const text = codeBlock.innerText;
            navigator.clipboard.writeText(text).then(() => {
                const icon = btn.querySelector('i');
                icon.className = 'fa-solid fa-check text-green-500';
                const originalText = btn.innerText;
                // btn.innerText = ' Copied'; 
                setTimeout(() => {
                    icon.className = 'fa-regular fa-copy';
                    // btn.innerText = ' Copy';
                }, 2000);
            });
        }
    </script>
</body>
</html>