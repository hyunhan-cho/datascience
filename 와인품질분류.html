<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>09. ì™€ì¸ í’ˆì§ˆ ë¶„ë¥˜ (ì´ˆë³´ì ì‹¤ìŠµ ê°€ì´ë“œ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <style>
        body {
            background-color: #f3f4f6;
            font-family: 'Pretendard', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #1f2937;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 40px;
            overflow: hidden;
            border: 1px solid #e5e7eb;
        }
        .card-header {
            background: #f9fafb;
            padding: 16px 24px;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-body {
            padding: 24px;
        }
        .markdown-content h1 { font-size: 2rem; font-weight: 800; margin-bottom: 1rem; color: #111827; }
        .markdown-content h2 { font-size: 1.5rem; font-weight: 700; margin-top: 1.5rem; margin-bottom: 1rem; color: #374151; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem; }
        .markdown-content h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.2rem; margin-bottom: 0.8rem; color: #4b5563; }
        .markdown-content p { margin-bottom: 1rem; }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
        
        pre {
            margin: 0 !important;
            border-radius: 8px !important;
            font-size: 0.9rem !important;
        }
        
        .output-area {
            background-color: #2d2d2d;
            color: #e0e0e0;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            border-left: 4px solid #10b981;
        }
        
        .badge {
            display: inline-block;
            padding: 2px 8px;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 9999px;
            background-color: #dbeafe;
            color: #1e40af;
            margin-right: 8px;
        }

        /* ë¹ˆì¹¸ ì±„ìš°ê¸° ìŠ¤íƒ€ì¼ */
        .fill-in {
            border: 2px dashed #8b5cf6;
            background-color: #f5f3ff;
        }
        .fill-in-badge {
            background-color: #ede9fe;
            color: #5b21b6;
        }

        .tip-box {
            background-color: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 16px;
            margin: 16px 0;
            border-radius: 4px;
        }
        .tip-title {
            font-weight: bold;
            color: #0369a1;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        html { scroll-behavior: smooth; }
        .section-marker { scroll-margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">

    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">09. ì™€ì¸ í’ˆì§ˆ ë¶„ë¥˜ (ë‹¤ì¤‘ ë¶„ë¥˜)</h1>
        <p class="text-lg text-gray-600">í™”ì´íŠ¸ ì™€ì¸ì˜ ì„±ë¶„ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬<br>í’ˆì§ˆ ë“±ê¸‰(0~4)ì„ ì˜ˆì¸¡í•˜ëŠ” ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.</p>
    </div>

    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h1>1. í™˜ê²½ ì¤€ë¹„ ë° ë°ì´í„° ë¡œë”©</h1>
            <p>ë”¥ëŸ¬ë‹ì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ë°ì´í„°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.</p>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸
        </div>
        <div class="card-body">
            <pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.model_selection import train_test_split
from sklearn.metrics import *
from sklearn.preprocessing import MinMaxScaler

# ë”¥ëŸ¬ë‹ í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
from keras.models import Sequential
from keras.layers import Dense, Input
from keras.backend import clear_session
from keras.optimizers import Adam</code></pre>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> í•™ìŠµ ê³¡ì„  í•¨ìˆ˜ (ë¯¸ë¦¬ ì •ì˜)
        </div>
        <div class="card-body">
            <pre><code class="language-python">def dl_history_plot(history):
    plt.figure(figsize=(10,6))
    plt.plot(history['loss'], label='train_err', marker = '.')
    plt.plot(history['val_loss'], label='val_err', marker = '.')

    plt.ylabel('Loss')
    plt.xlabel('Epoch')
    plt.legend()
    plt.grid()
    plt.show()</code></pre>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600">ì™€ì¸ í’ˆì§ˆ(quality)ì€ ì›ë˜ 3~9ì  ì‚¬ì´ì˜ ê°’ì…ë‹ˆë‹¤. ì´ë¥¼ í•™ìŠµí•˜ê¸° ì¢‹ê²Œ <strong>0~4 (5ê°œ ë“±ê¸‰)</strong>ìœ¼ë¡œ ì •ë¦¬í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">path = "https://raw.githubusercontent.com/DA4BAM/dataset/master/winequality-white.csv"
data = pd.read_csv(path)

# í’ˆì§ˆ(Target) ë²”ì£¼ ì¬ì¡°ì • (3~9 -> 0~4)
# (ì´ ì½”ë“œëŠ” ì œê³µëœ ë°ì´í„°ì…‹ íŠ¹ì„±ì— ë§ì¶˜ ì „ì²˜ë¦¬ì…ë‹ˆë‹¤)
data['quality'] = np.where(data['quality'] == 3, 4, np.where(data['quality'] == 9, 8, data['quality']))
data['quality'] = data['quality'] - 4

print(data['quality'].value_counts().sort_index())</code></pre>
            <div class="output-area">0    183  (ìµœí•˜)
1    1457
2    2198
3    880
4    180  (ìµœìƒ)
Name: quality, dtype: int64</div>
            <div class="tip-box">
                <div class="tip-title">ğŸ¯ ëª©í‘œ í™•ì¸</div>
                <p>ìš°ë¦¬ì˜ ëª©í‘œëŠ” ì™€ì¸ ì„±ë¶„(ì•Œì½”ì˜¬, ì‚°ë„ ë“±)ì„ ë³´ê³  ì´ ì™€ì¸ì´ <strong>0, 1, 2, 3, 4 ì¤‘ ì–´ë””ì— ì†í•˜ëŠ”ì§€</strong> ë§ì¶”ëŠ” ê²ƒì…ë‹ˆë‹¤. (5ê°œ í´ë˜ìŠ¤ ë‹¤ì¤‘ ë¶„ë¥˜)</p>
            </div>
        </div>
    </div>

    <div class="card section-marker fill-in">
        <div class="card-body markdown-content">
            <h1>2. ë°ì´í„° ì¤€ë¹„ (ë¹ˆì¹¸ ì±„ìš°ê¸°)</h1>
            <p>ë…¸íŠ¸ë¶ì—ì„œ ë¹„ì–´ìˆë˜ ë¶€ë¶„ì…ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ë‚˜ëˆ„ê³  ìŠ¤ì¼€ì¼ë§ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.</p>
        </div>
    </div>

    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">Solution</span> ë°ì´í„° ë¶„í•  (x, y ë‚˜ëˆ„ê¸° & Train/Test ë¶„ë¦¬)
        </div>
        <div class="card-body">
            <pre><code class="language-python"># 1. x, y ë¶„ë¦¬
target = 'quality'
x = data.drop(target, axis=1)
y = data.loc[:, target]

# 2. Train / Validation ë¶„ë¦¬ (7:3 ë˜ëŠ” 8:2)
x_train, x_val, y_train, y_val = train_test_split(x, y, test_size=0.2, random_state=42)

print(f"Train shape: {x_train.shape}")
print(f"Val shape: {x_val.shape}")</code></pre>
            <div class="output-area">Train shape: (3918, 11)
Val shape: (980, 11)</div>
        </div>
    </div>

    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">Solution</span> ìŠ¤ì¼€ì¼ë§ (MinMaxScaler)
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600">ë”¥ëŸ¬ë‹ì—ì„œëŠ” ë°ì´í„°ì˜ ë²”ìœ„(Scale)ë¥¼ 0~1 ì‚¬ì´ë¡œ ë§ì¶°ì£¼ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python"># ìŠ¤ì¼€ì¼ëŸ¬ ì„ ì–¸
scaler = MinMaxScaler()

# í•™ìŠµ ë°ì´í„°(Train) ê¸°ì¤€ìœ¼ë¡œ ìŠ¤ì¼€ì¼ë§ í•™ìŠµ ë° ë³€í™˜
x_train = scaler.fit_transform(x_train)

# ê²€ì¦ ë°ì´í„°(Validation)ëŠ” í•™ìŠµ ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ ë³€í™˜ë§Œ ìˆ˜í–‰
x_val = scaler.transform(x_val)</code></pre>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h1>3. ëª¨ë¸ë§ (3ê°€ì§€ ë²„ì „)</h1>
            <p>ì„±ëŠ¥ì„ ë†’ì´ê¸° ìœ„í•´ ëª¨ë¸ì˜ êµ¬ì¡°ë¥¼ ì¡°ê¸ˆì”© ë°”ê¿”ê°€ë©° 3ê°€ì§€ ì‹¤í—˜ì„ ì§„í–‰í•©ë‹ˆë‹¤.</p>
        </div>
    </div>

    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">Model 1</span> ê¸°ë³¸ ëª¨ë¸ (ì€ë‹‰ì¸µ ì—†ìŒ)
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600">ê°€ì¥ ë‹¨ìˆœí•˜ê²Œ, ì…ë ¥ì¸µê³¼ ì¶œë ¥ì¸µë§Œ ì—°ê²°í•´ ë´…ë‹ˆë‹¤.</p>
            <pre><code class="language-python">nfeatures = x_train.shape[1] # 11ê°œ

clear_session()

model1 = Sequential([
    Input(shape=(nfeatures,)),
    # ì¶œë ¥ì¸µ: 0~4ê¹Œì§€ 5ê°œë¡œ ë¶„ë¥˜í•˜ë¯€ë¡œ ë…¸ë“œìˆ˜ 5, í™œì„±í™”í•¨ìˆ˜ëŠ” softmax
    Dense(5, activation='softmax')
])

model1.compile(optimizer=Adam(learning_rate=0.01), loss='sparse_categorical_crossentropy')

history1 = model1.fit(x_train, y_train, epochs=20, validation_split=0.2).history
dl_history_plot(history1)</code></pre>
            <div class="tip-box">
                <div class="tip-title">ğŸ’¡ Tip: ì¶œë ¥ì¸µ ì„¤ì •</div>
                <ul class="list-disc pl-5 text-sm">
                    <li><strong>ë…¸ë“œ ìˆ˜ 5:</strong> ì •ë‹µ(Class)ì´ 0, 1, 2, 3, 4 ì´ 5ê°œì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</li>
                    <li><strong>softmax:</strong> 5ê°œ ì¤‘ í™•ë¥ ì´ ê°€ì¥ ë†’ì€ í•˜ë‚˜ë¥¼ ê³ ë¥´ê¸° ìœ„í•œ í•¨ìˆ˜ì…ë‹ˆë‹¤.</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">Model 2</span> ì€ë‹‰ì¸µ ì¶”ê°€ (Deep Learning)
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600">ì¤‘ê°„ì— í•™ìŠµì„ ë„ì™€ì¤„ ì€ë‹‰ì¸µ(Hidden Layer)ì„ 2ê°œ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">clear_session()

model2 = Sequential([
    Input(shape=(nfeatures,)),
    
    # ì€ë‹‰ì¸µ ì¶”ê°€: reluëŠ” í•™ìŠµ íš¨ìœ¨ì´ ì¢‹ìŠµë‹ˆë‹¤.
    Dense(32, activation='relu'),
    Dense(16, activation='relu'),
    
    # ì¶œë ¥ì¸µ
    Dense(5, activation='softmax')
])

model2.compile(optimizer=Adam(learning_rate=0.001), loss='sparse_categorical_crossentropy')

history2 = model2.fit(x_train, y_train, epochs=30, validation_split=0.2).history
dl_history_plot(history2)</code></pre>
        </div>
    </div>

    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">Model 3</span> ë” ê¹Šê³  ë„“ì€ ëª¨ë¸
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600">ë‰´ëŸ°ì˜ ê°œìˆ˜ë¥¼ ëŠ˜ë¦¬ê³  ì¸µì„ ë” ìŒ“ì•„ì„œ ì„±ëŠ¥ ë³€í™”ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python">clear_session()

model3 = Sequential([
    Input(shape=(nfeatures,)),
    
    Dense(64, activation='relu'),
    Dense(32, activation='relu'),
    Dense(16, activation='relu'),
    
    Dense(5, activation='softmax')
])

model3.compile(optimizer=Adam(learning_rate=0.001), loss='sparse_categorical_crossentropy')

history3 = model3.fit(x_train, y_train, epochs=50, validation_split=0.2).history
dl_history_plot(history3)</code></pre>
            <div class="output-area">[ê·¸ë˜í”„ ë¹„êµ]
ë³´í†µ ì¸µì„ ê¹Šê²Œ ìŒ“ì„ìˆ˜ë¡(Model 3) í•™ìŠµ ë°ì´í„°ì— ëŒ€í•œ ì˜¤ì°¨(Loss)ëŠ” ì¤„ì–´ë“¤ì§€ë§Œ,
ê²€ì¦ ë°ì´í„°(Val Loss)ê°€ ë‹¤ì‹œ íŠ€ì–´ ì˜¤ë¥´ëŠ” 'ê³¼ì í•©(Overfitting)' í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ìµœì¢… ê²°ê³¼ í™•ì¸ (Model 3 ê¸°ì¤€)
        </div>
        <div class="card-body">
            <pre><code class="language-python"># ì˜ˆì¸¡ê°’ ìƒì„±
pred = model3.predict(x_val)
pred_class = pred.argmax(axis=1) # í™•ë¥  ì¤‘ ê°€ì¥ í° ê°’ì˜ ì¸ë±ìŠ¤ ì¶”ì¶œ

# ì„±ëŠ¥ í‰ê°€
print(confusion_matrix(y_val, pred_class))
print("-" * 50)
print(classification_report(y_val, pred_class))</code></pre>
        </div>
    </div>

    <div class="text-center mt-12 mb-20">
        <p class="text-gray-500">ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤! ì´ì œ ì—¬ëŸ¬ë¶„ì€ ì§ì ‘ ëª¨ë¸ì˜ êµ¬ì¡°ë¥¼ ë°”ê¿”ê°€ë©° ì„±ëŠ¥ì„ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</body>
</html>