<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08. ì¼ë°˜í™” ì„±ëŠ¥ê³¼ êµì°¨ ê²€ì¦ (ì´ˆë³´ì ê°€ì´ë“œ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <style>
        body {
            background-color: #f3f4f6;
            font-family: 'Pretendard', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #1f2937;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 40px;
            overflow: hidden;
            border: 1px solid #e5e7eb;
        }
        .card-header {
            background: #f9fafb;
            padding: 16px 24px;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-body {
            padding: 24px;
        }
        /* ë§ˆí¬ë‹¤ìš´ ìŠ¤íƒ€ì¼ */
        .markdown-content h1 { font-size: 2rem; font-weight: 800; margin-bottom: 1rem; color: #111827; }
        .markdown-content h2 { font-size: 1.5rem; font-weight: 700; margin-top: 1.5rem; margin-bottom: 1rem; color: #374151; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem; }
        .markdown-content h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.2rem; margin-bottom: 0.8rem; color: #4b5563; }
        .markdown-content p { margin-bottom: 1rem; }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
        
        /* ì½”ë“œ ë¸”ë¡ ìŠ¤íƒ€ì¼ */
        pre {
            margin: 0 !important;
            border-radius: 8px !important;
            font-size: 0.9rem !important;
        }
        
        /* ì¶œë ¥ ê²°ê³¼ì°½ ìŠ¤íƒ€ì¼ */
        .output-area {
            background-color: #2d2d2d;
            color: #e0e0e0;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            border-left: 4px solid #10b981;
        }
        
        .badge {
            display: inline-block;
            padding: 2px 8px;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 9999px;
            background-color: #dbeafe;
            color: #1e40af;
            margin-right: 8px;
        }

        /* ì„¤ëª… íŒ ë°•ìŠ¤ */
        .tip-box {
            background-color: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 16px;
            margin: 16px 0;
            border-radius: 4px;
        }
        .tip-title {
            font-weight: bold;
            color: #0369a1;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* ìŠ¤í¬ë¡¤ ê´€ë ¨ */
        html { scroll-behavior: smooth; }
        .section-marker { scroll-margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">

    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">08. ì¼ë°˜í™” ì„±ëŠ¥ê³¼ êµì°¨ ê²€ì¦</h1>
        <p class="text-lg text-gray-600">ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸, í•œ ë²ˆë§Œ í‰ê°€í•˜ë©´ ìœ„í—˜í•œ ì´ìœ ì™€<br>ì´ë¥¼ í•´ê²°í•˜ëŠ” <strong>K-Fold Cross Validation</strong> ì™„ë²½ ê°€ì´ë“œ</p>
    </div>

    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h1>ì¼ë°˜í™” ì„±ëŠ¥ (Generalization)</h1>
            <p>ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ë§Œë“¤ ë•Œ ê°€ì¥ ì¤‘ìš”í•œ ëª©í‘œëŠ” <strong>"ì•ˆ ë³¸ ë°ì´í„°(New Data)ë„ ì˜ ë§ì¶”ëŠ” ê²ƒ"</strong>ì…ë‹ˆë‹¤. ì´ë¥¼ <strong>ì¼ë°˜í™” ì„±ëŠ¥</strong>ì´ë¼ê³  í•©ë‹ˆë‹¤.</p>
            <div class="tip-box">
                <div class="tip-title">ğŸ¤” ì™œ í•œ ë²ˆë§Œ í‰ê°€í•˜ë©´ ì•ˆ ë˜ë‚˜ìš”?</div>
                <p>ë°ì´í„°ë¥¼ ë‚˜ëˆŒ ë•Œ(Train/Validation) <strong>ìš´(Luck)</strong>ì´ ì‘ìš©í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.<br>
                - <strong>ìš´ ì¢‹ìŒ:</strong> ì‰¬ìš´ ë¬¸ì œë§Œ ì‹œí—˜(Validation)ì— ë‚˜ì˜´ â” ì ìˆ˜ ë»¥íŠ€ê¸°<br>
                - <strong>ìš´ ë‚˜ì¨:</strong> ì–´ë ¤ìš´ ë¬¸ì œë§Œ ì‹œí—˜ì— ë‚˜ì˜´ â” ì ìˆ˜ í­ë½<br>
                <br>
                ì¦‰, í•œ ë²ˆì˜ ê²°ê³¼ë¡œëŠ” ì´ ëª¨ë¸ì´ ì§„ì§œ ë˜‘ë˜‘í•œ ê±´ì§€, ìš´ì´ ì¢‹ì•˜ë˜ ê±´ì§€ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h2>1. ë°ì´í„° ì¤€ë¹„ ë° ì „ì²˜ë¦¬</h2>
            <p>ì§ì›ì˜ ì •ë³´ë¥¼ ë³´ê³  ì´ ì‚¬ëŒì´ <strong>ì´ì§í• ì§€(Attrition=1) ì•ˆ í• ì§€(Attrition=0)</strong> ë§ì¶”ëŠ” ë°ì´í„°ì…‹ì…ë‹ˆë‹¤.</p>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ë°ì´í„° ë¡œë“œ ë° ì •ë¦¬
        </div>
        <div class="card-body">
            <pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
path = "https://raw.githubusercontent.com/DA4BAM/dataset/master/Attrition_simple2.CSV"
data = pd.read_csv(path)

# [ì¤‘ìš”] ì‚¬ë²ˆ(EmployeeNumber) ì œê±°
# ì´ìœ : ì‚¬ë²ˆì€ ê·¸ëƒ¥ ë²ˆí˜¸í‘œì¼ ë¿, ì´ì§ê³¼ëŠ” ì•„ë¬´ ìƒê´€ì´ ì—†ëŠ” ì •ë³´ë¼ì„œ í•™ìŠµì— ë°©í•´ë§Œ ë©ë‹ˆë‹¤.
data.drop('EmployeeNumber', axis=1, inplace=True)

print(data.head())</code></pre>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ê°€ë³€ìˆ˜í™” (One-Hot Encoding)
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600">ì»´í“¨í„°ëŠ” 'Sales', 'Research' ê°™ì€ <strong>ê¸€ì(ë²”ì£¼í˜•)</strong>ë¥¼ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ë¥¼ 0ê³¼ 1ì˜ ìˆ«ìë¡œ ë°”ê¿”ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>
            <pre><code class="language-python"># 1. X(ë¬¸ì œ)ì™€ Y(ì •ë‹µ) ë¶„ë¦¬
target = 'Attrition'
x = data.drop(target, axis=1)
y = data.loc[:, target]

# 2. ê°€ë³€ìˆ˜í™” ëŒ€ìƒ ì§€ì • (ê¸€ìë¡œ ëœ ì»¬ëŸ¼ë“¤)
dum_cols = ['Department', 'Gender', 'JobSatisfaction', 'MaritalStatus', 'OverTime']

# 3. ê°€ë³€ìˆ˜í™” ì‹¤í–‰
# drop_first=True: 'ë‚¨ì', 'ì—¬ì' ì»¬ëŸ¼ì„ ë‘˜ ë‹¤ ë§Œë“¤ í•„ìš” ì—†ì´, 'ë‚¨ì' ì»¬ëŸ¼ í•˜ë‚˜ë§Œ ìˆì–´ë„ 0ì´ë©´ ì—¬ìì„ì„ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ í•˜ë‚˜ë¥¼ ì§€ì›ë‹ˆë‹¤.
x = pd.get_dummies(x, columns=dum_cols, drop_first=True)

print(x.head())</code></pre>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h2>2. ì‹¤í—˜: ëœë¤ ë¶„í• ì˜ ìœ„í—˜ì„± í™•ì¸</h2>
            <p>ë°ì´í„°ë¥¼ ë‚˜ëˆ„ëŠ” ì‘ì—…ì„ <strong>50ë²ˆ ë°˜ë³µ</strong>í•´ ë³´ê² ìŠµë‹ˆë‹¤. ë˜‘ê°™ì€ ëª¨ë¸ì¸ë° ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ë‚˜ëˆ„ëŠëƒì— ë”°ë¼ ì ìˆ˜ê°€ ì–¼ë§ˆë‚˜ ë„ë›°ê¸°í•˜ëŠ”ì§€ í™•ì¸í•´ ë´…ì‹œë‹¤.</p>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> 50ë²ˆ ë°˜ë³µ ì‹¤í—˜ (ì‹œë®¬ë ˆì´ì…˜)
        </div>
        <div class="card-body">
            <pre><code class="language-python">from sklearn.tree import DecisionTreeClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score
from sklearn.preprocessing import MinMaxScaler

# ì ìˆ˜ë¥¼ ê¸°ë¡í•  ë¹ˆ ë¦¬ìŠ¤íŠ¸ ìƒì„±
r_dt = []  # Decision Treeìš©
r_knn = [] # KNNìš©
scaler = MinMaxScaler()

# 50ë²ˆ ë°˜ë³µ (Loop)
for i in range(50):
    # 1. ë°ì´í„° ë¶„í•  (random_stateë¥¼ ì•ˆ ì“°ë©´ ë§¤ë²ˆ ë‹¤ë¥´ê²Œ ì„ì„!)
    x_train, x_val, y_train, y_val = train_test_split(x, y, test_size=0.2)

    # [ëª¨ë¸ 1] Decision Tree (ì§ˆë¬¸ ìŠ¤ë¬´ê³ ê°œ ë°©ì‹)
    model_dt = DecisionTreeClassifier(max_depth=3)
    model_dt.fit(x_train, y_train)
    pred_dt = model_dt.predict(x_val)
    r_dt.append(accuracy_score(y_val, pred_dt)) # ì ìˆ˜ ê¸°ë¡

    # [ëª¨ë¸ 2] KNN (ê±°ë¦¬ ê¸°ë°˜, ìŠ¤ì¼€ì¼ë§ í•„ìˆ˜!)
    # KNNì€ ê±°ë¦¬ ê³„ì‚°ì„ í•˜ë¯€ë¡œ ìˆ«ìì˜ í¬ê¸°ë¥¼ ë§ì¶°ì£¼ëŠ” ìŠ¤ì¼€ì¼ë§ì´ ê¼­ í•„ìš”í•©ë‹ˆë‹¤.
    x_train_s = scaler.fit_transform(x_train)
    x_val_s = scaler.transform(x_val)
    
    model_knn = KNeighborsClassifier()
    model_knn.fit(x_train_s, y_train)
    pred_knn = model_knn.predict(x_val_s)
    r_knn.append(accuracy_score(y_val, pred_knn)) # ì ìˆ˜ ê¸°ë¡</code></pre>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ê²°ê³¼ ëˆˆìœ¼ë¡œ í™•ì¸í•˜ê¸° (ê·¸ë˜í”„)
        </div>
        <div class="card-body">
            <pre><code class="language-python">plt.figure(figsize=(10, 6))

# KDE Plot: ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ì‚° ëª¨ì–‘ìœ¼ë¡œ ê·¸ë ¤ì¤ë‹ˆë‹¤.
sns.kdeplot(r_dt, label='Decision Tree', fill=True, alpha=0.3)
sns.kdeplot(r_knn, label='KNN', fill=True, alpha=0.3)

# í‰ê· ê°’ì— ì ì„  í‘œì‹œ
plt.axvline(np.mean(r_dt), color='blue', linestyle='--', label='DT Mean')
plt.axvline(np.mean(r_knn), color='orange', linestyle='--', label='KNN Mean')

plt.title("ëª¨ë¸ ì„±ëŠ¥ ë¶„í¬ (50ë²ˆ ë°˜ë³µ)")
plt.xlabel("ì •í™•ë„ (Accuracy)")
plt.legend()
plt.grid()
plt.show()</code></pre>
            <div class="tip-box">
                <div class="tip-title">ğŸ“Š ê·¸ë˜í”„ í•´ì„ ë°©ë²•</div>
                <ul class="list-disc pl-5 space-y-2 text-sm">
                    <li><strong>ê·¸ë˜í”„ì˜ ìœ„ì¹˜ (í‰ê· ):</strong> ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì¹˜ìš°ì¹ ìˆ˜ë¡ ì„±ëŠ¥ì´ ì¢‹ì€ ëª¨ë¸ì…ë‹ˆë‹¤.</li>
                    <li><strong>ê·¸ë˜í”„ì˜ í­ (í‘œì¤€í¸ì°¨):</strong> í­ì´ ì¢ê³  ë¾°ì¡±í• ìˆ˜ë¡ <strong>ì•ˆì •ì ì¸ ëª¨ë¸</strong>ì…ë‹ˆë‹¤. (ë°ì´í„° ìš´ë¹¨ì„ ëœ íƒ)</li>
                    <li>í­ì´ ë„ˆë¬´ ë„“ìœ¼ë©´, ë‚´ê°€ ë§Œë“  ëª¨ë¸ì´ ë‚´ì¼ì€ ì„±ëŠ¥ì´ ëš ë–¨ì–´ì§ˆ ìˆ˜ë„ ìˆë‹¤ëŠ” ëœ»ì´ë¯€ë¡œ ìœ„í—˜í•©ë‹ˆë‹¤.</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h2>3. í•´ê²°ì±…: êµì°¨ ê²€ì¦ (Cross Validation)</h2>
            <p>ìœ„ì²˜ëŸ¼ ë°˜ë³µë¬¸ì„ ì§œëŠ” ê±´ ê·€ì°®ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë‚˜ì˜¨ ë°©ë²•ì´ <strong>K-Fold Cross Validation</strong>ì…ë‹ˆë‹¤.</p>
            
            <div class="bg-gray-100 p-4 rounded-lg border border-gray-300 mb-4">
                <h3 class="font-bold text-gray-700 mb-2">ğŸ’¡ í•µì‹¬ ì•„ì´ë””ì–´</h3>
                <p>ë°ì´í„°ë¥¼ ì¼€ì´í¬ ìë¥´ë“¯ 10ì¡°ê°(Fold) ëƒ…ë‹ˆë‹¤.<br>
                ëª¨ë“  ì¡°ê°ì´ í•œ ë²ˆì”©ì€ 'ì‹œí—˜ ë¬¸ì œ(Validation)' ì—­í• ì„ ëŒì•„ê°€ë©´ì„œ ë§¡ìŠµë‹ˆë‹¤.<br>
                ì´ë ‡ê²Œ ë‚˜ì˜¨ 10ê°œì˜ ì ìˆ˜ë¥¼ <strong>í‰ê· </strong> ë‚´ë©´ ê°€ì¥ ê³µì •í•œ í‰ê°€ê°€ ë©ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> êµì°¨ ê²€ì¦ í•œ ì¤„ë¡œ ëë‚´ê¸°
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600"><code>cross_val_score</code> í•¨ìˆ˜ê°€ ì•Œì•„ì„œ ë‚˜ëˆ„ê³ , í•™ìŠµí•˜ê³ , í‰ê°€ê¹Œì§€ ë‹¤ í•´ì¤ë‹ˆë‹¤.</p>
            <pre><code class="language-python">from sklearn.model_selection import cross_val_score

# 1. ëª¨ë¸ ì„ ì–¸ (ì•„ì§ í•™ìŠµ ì „)
model_dt = DecisionTreeClassifier(max_depth=3)

# 2. êµì°¨ ê²€ì¦ ìˆ˜í–‰ (cv=10 : 10ë“±ë¶„ í•˜ê² ë‹¤ëŠ” ëœ»)
# ì£¼ì˜: x, y ì „ì²´ ë°ì´í„°ë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤. í•¨ìˆ˜ê°€ ì•Œì•„ì„œ ìª¼ê°œ ì”ë‹ˆë‹¤.
cv_result = cross_val_score(model_dt, x, y, cv=10)

print("10ë²ˆì˜ ì‹œí—˜ ì ìˆ˜:", cv_result)
print("-" * 30)
print(f"í‰ê·  ì ìˆ˜: {cv_result.mean():.4f}")
print(f"ì ìˆ˜ í¸ì°¨: {cv_result.std():.4f}")</code></pre>
            <div class="output-area">10ë²ˆì˜ ì‹œí—˜ ì ìˆ˜: [0.84 0.81 0.89 0.82 ... ]
------------------------------
í‰ê·  ì ìˆ˜: 0.8452 (ì´ê²ƒì´ ëª¨ë¸ì˜ ì§„ì§œ ì‹¤ë ¥!)
ì ìˆ˜ í¸ì°¨: 0.0213</div>
        </div>
    </div>

    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> KNN êµì°¨ ê²€ì¦ ì‹œ ì£¼ì˜ì‚¬í•­
        </div>
        <div class="card-body">
            <div class="tip-box">
                <div class="tip-title">âš ï¸ ìŠ¤ì¼€ì¼ë§ ì£¼ì˜!</div>
                <p>KNNì€ ìŠ¤ì¼€ì¼ë§ì´ ì•ˆ ëœ ë°ì´í„°ë¥¼ ë„£ìœ¼ë©´ ì„±ëŠ¥ì´ ì—‰ë§ì´ ë©ë‹ˆë‹¤.<br>
                êµì°¨ ê²€ì¦ì„ í•  ë•ŒëŠ” í¸ì˜ìƒ <strong>ì „ì²´ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ìŠ¤ì¼€ì¼ë§</strong>í•´ì„œ ë„£ì–´ì£¼ëŠ” ë°©ë²•ì„ ë§ì´ ì”ë‹ˆë‹¤.</p>
            </div>
            <pre><code class="language-python"># 1. ì „ì²´ ë°ì´í„° ìŠ¤ì¼€ì¼ë§í•˜ê¸°
scaler = MinMaxScaler()
x_scaled = scaler.fit_transform(x) # ì „ì²´ xë¥¼ ë³€í™˜

# 2. ëª¨ë¸ ë§Œë“¤ê¸°
model_knn = KNeighborsClassifier()

# 3. ìŠ¤ì¼€ì¼ë§ ëœ ë°ì´í„°(x_scaled)ë¡œ êµì°¨ ê²€ì¦
cv_result_knn = cross_val_score(model_knn, x_scaled, y, cv=10)

print(f"KNN í‰ê·  ì ìˆ˜: {cv_result_knn.mean():.4f}")
print(f"KNN ì ìˆ˜ í¸ì°¨: {cv_result_knn.std():.4f}")</code></pre>
        </div>
    </div>

    <div class="text-center mt-12 mb-20">
        <p class="text-gray-500 text-lg">"í˜„ì—…ì—ì„œëŠ” <strong>Cross Validationì˜ í‰ê·  ì ìˆ˜</strong>ë¥¼<br>ê°€ì¥ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„±ëŠ¥ ì§€í‘œë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤."</p>
    </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</body>
</html>