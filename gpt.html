<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT-2 íŒŒì¸íŠœë‹ ì‹¤ìŠµ ê°€ì´ë“œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons (Updated CDN) -->
    <script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=JetBrains+Mono:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        code, pre {
            font-family: 'JetBrains Mono', monospace;
        }
        .code-block {
            background-color: #1a1b26;
            color: #a9b1d6;
        }
        .code-keyword { color: #bb9af7; }
        .code-string { color: #9ece6a; }
        .code-comment { color: #565f89; font-style: italic; }
        .code-function { color: #7aa2f7; }
        .code-number { color: #ff9e64; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #c7c7c7;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 bg-white/90 backdrop-blur-md border-b border-gray-200 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <i data-lucide="brain-circuit" class="h-8 w-8 text-indigo-600 mr-3"></i>
                    <span class="font-bold text-xl tracking-tight text-gray-900">GPT-2 Fine-Tuning Lab</span>
                </div>
                
                <!-- Desktop Nav -->
                <div class="hidden md:flex items-center space-x-1" id="desktop-nav">
                    <!-- Nav items will be injected by JS -->
                </div>

                <!-- Mobile Menu Button -->
                <div class="flex items-center md:hidden">
                    <button id="mobile-menu-btn" class="p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none">
                        <i data-lucide="menu" class="h-6 w-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Nav -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-b border-gray-200 shadow-lg">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3" id="mobile-nav-items">
                <!-- Nav items will be injected by JS -->
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-24 pb-20">

        <!-- Intro Section -->
        <section id="intro" class="mb-20 scroll-mt-24 section-container">
            <div class="flex items-center space-x-3 mb-6 border-b border-gray-200 pb-4">
                <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600">
                    <i data-lucide="book-open" class="w-6 h-6"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">ì‹¤ìŠµ ì†Œê°œ: GPT-2 íŒŒì¸íŠœë‹</h2>
            </div>
            
            <div class="prose max-w-none text-gray-600">
                <p class="text-lg mb-6">
                    ì´ íŠœí† ë¦¬ì–¼ì€ <strong>GPT-2 ëª¨ë¸</strong>ì— <strong>LoRA(Low-Rank Adaptation)</strong> ê¸°ìˆ ì„ ì ìš©í•˜ì—¬,
                    ì ì€ ë°ì´í„°ë¡œë„ ëª¨ë¸ì´ íŠ¹ì • ì§ˆë¬¸ì— ì›í•˜ëŠ” ë‹µë³€ì„ í•˜ë„ë¡ í›ˆë ¨ì‹œí‚¤ëŠ” ê³¼ì •ì„ ë‹¤ë£¹ë‹ˆë‹¤.
                </p>

                <!-- Comparison Table -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-8">
                    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
                        <h3 class="font-bold text-gray-800">DistilBERT vs GPT-2 ë¹„êµ</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm text-left">
                            <thead class="bg-gray-50 text-gray-500 font-medium">
                                <tr>
                                    <th class="px-6 py-3">í•­ëª©</th>
                                    <th class="px-6 py-3">DistilBERT (ì´ì „ ì‹¤ìŠµ)</th>
                                    <th class="px-6 py-3 text-indigo-600">GPT-2 (ì´ë²ˆ ì‹¤ìŠµ)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-3 font-medium">ëª¨ë¸ íƒ€ì…</td>
                                    <td class="px-6 py-3">Encoder (ì´í•´ ì¤‘ì‹¬)</td>
                                    <td class="px-6 py-3">Decoder (ìƒì„± ì¤‘ì‹¬)</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-medium">ì£¼ìš” ëª©ì </td>
                                    <td class="px-6 py-3">ë¶„ë¥˜ (ê¸ì •/ë¶€ì • ë“±)</td>
                                    <td class="px-6 py-3">ìƒì„± (ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡)</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-medium">íŒŒë¼ë¯¸í„° ìˆ˜</td>
                                    <td class="px-6 py-3">ì•½ 66M</td>
                                    <td class="px-6 py-3">ì•½ 124M</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="bg-indigo-50 border-l-4 border-indigo-500 p-4 my-6 rounded-r-lg">
                    <h4 class="font-bold text-indigo-800 mb-2">ğŸ¯ í•µì‹¬ ëª©í‘œ</h4>
                    <p class="text-indigo-700 text-sm">
                        GPT-2ì—ê²Œ "ìš°ë¦¬ì§‘ ê°•ì•„ì§€ ì´ë¦„ì€?"ì´ë¼ê³  ë¬¼ì—ˆì„ ë•Œ, ì›ë˜ëŠ” ì—‰ëš±í•œ ë§ì„ í•˜ê² ì§€ë§Œ 
                        í•™ìŠµ í›„ì—ëŠ” <strong>"ìˆœë‘¥ì´"</strong>ë¼ê³  ëŒ€ë‹µí•˜ê²Œ ë§Œë“œëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </section>

        <!-- Step 1: Environment -->
        <section id="setup" class="mb-20 scroll-mt-24 section-container">
            <div class="flex items-center space-x-3 mb-6 border-b border-gray-200 pb-4">
                <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600">
                    <i data-lucide="settings" class="w-6 h-6"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">STEP 1~2: í™˜ê²½ ì„¤ì • ë° ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>
            </div>

            <div class="bg-white border-l-4 border-indigo-500 pl-4 py-2 my-4 shadow-sm">
                <h4 class="font-bold text-gray-800 mb-2">í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜</h4>
                <p class="text-gray-600 text-sm leading-relaxed">
                    íš¨ìœ¨ì ì¸ í•™ìŠµì„ ìœ„í•´ <code>peft</code>(LoRA ì§€ì›)ì™€ <code>bitsandbytes</code>(ê²½ëŸ‰í™”) ê°™ì€ ìµœì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í•¨ê»˜ ì„¤ì¹˜í•©ë‹ˆë‹¤.
                </p>
            </div>

            <div class="code-block rounded-lg overflow-hidden my-4 shadow-lg border border-gray-800">
                <div class="flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700">
                    <div class="flex space-x-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <span class="text-xs text-gray-400 font-mono">bash / python</span>
                </div>
                <div class="p-4 overflow-x-auto">
<pre><code class="text-sm"># STEP 1: í™˜ê²½ ì„¤ì •
!pip install -q transformers datasets peft accelerate bitsandbytes

# STEP 2: ê¸°ë³¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸
<span class="code-keyword">import</span> torch  <span class="code-comment"># PyTorch: ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬</span>
<span class="code-keyword">from</span> datasets <span class="code-keyword">import</span> Dataset  <span class="code-comment"># ë°ì´í„°ì…‹ ì²˜ë¦¬</span>
<span class="code-keyword">from</span> transformers <span class="code-keyword">import</span> (
    AutoTokenizer, 
    AutoModelForCausalLM, 
    TrainingArguments, 
    Trainer, 
    DataCollatorForLanguageModeling
)
<span class="code-keyword">from</span> peft <span class="code-keyword">import</span> get_peft_model, LoraConfig, TaskType  <span class="code-comment"># LoRA í•µì‹¬ ëª¨ë“ˆ</span></code></pre>
                </div>
            </div>
        </section>

        <!-- Step 3: Model Load -->
        <section id="model" class="mb-20 scroll-mt-24 section-container">
            <div class="flex items-center space-x-3 mb-6 border-b border-gray-200 pb-4">
                <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600">
                    <i data-lucide="brain" class="w-6 h-6"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">STEP 3: ëª¨ë¸ ë° í† í¬ë‚˜ì´ì € ë¡œë“œ</h2>
            </div>

            <div class="bg-white border-l-4 border-indigo-500 pl-4 py-2 my-4 shadow-sm">
                <h4 class="font-bold text-gray-800 mb-2">GPT-2 ëª¨ë¸ ì¤€ë¹„</h4>
                <p class="text-gray-600 text-sm leading-relaxed">
                    GPT-2ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ <code>pad_token</code>(ë¹ˆ ê³µê°„ ì±„ìš°ê¸°ìš© í† í°)ì´ ì—†ìŠµë‹ˆë‹¤. 
                    ë”°ë¼ì„œ <code>eos_token</code>(ë¬¸ì¥ ë í† í°)ì„ íŒ¨ë”© í† í°ìœ¼ë¡œ ëŒ€ì‹  ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•´ ì£¼ì–´ì•¼ ì—ëŸ¬ê°€ ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </p>
            </div>

            <div class="code-block rounded-lg overflow-hidden my-4 shadow-lg border border-gray-800">
                <div class="flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700">
                    <span class="text-xs text-gray-400 font-mono">python</span>
                </div>
                <div class="p-4 overflow-x-auto">
<pre><code class="text-sm"># STEP 3: ëª¨ë¸ ë° í† í¬ë‚˜ì´ì € ë¡œë“œ
model_id = <span class="code-string">"gpt2"</span>

# í† í¬ë‚˜ì´ì € ë¡œë“œ
tokenizer = AutoTokenizer.from_pretrained(model_id)

# ğŸ’¡ ì¤‘ìš”: GPT-2ëŠ” pad_tokenì´ ì—†ì–´ì„œ eos_tokenìœ¼ë¡œ ëŒ€ì²´ ì„¤ì •
tokenizer.pad_token = tokenizer.eos_token

# ëª¨ë¸ ë¡œë“œ (CausalLM: ì¸ê³¼ì  ì–¸ì–´ ëª¨ë¸ë§ìš©)
model = AutoModelForCausalLM.from_pretrained(model_id)</code></pre>
                </div>
            </div>
        </section>

        <!-- Step 4: LoRA Config -->
        <section id="lora" class="mb-20 scroll-mt-24 section-container">
            <div class="flex items-center space-x-3 mb-6 border-b border-gray-200 pb-4">
                <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600">
                    <i data-lucide="layers" class="w-6 h-6"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">STEP 4: LoRA ì„¤ì • (í•µì‹¬!)</h2>
            </div>

            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 my-4">
                <h4 class="font-bold text-yellow-800 mb-2 flex items-center"><i data-lucide="zap" class="w-4 h-4 mr-2"></i>LoRAë€?</h4>
                <p class="text-yellow-700 text-sm mb-2">
                    ê±°ëŒ€ ëª¨ë¸ì˜ ëª¨ë“  íŒŒë¼ë¯¸í„°ë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ê±´ ë„ˆë¬´ ë¬´ê²ìŠµë‹ˆë‹¤. LoRAëŠ” ëª¨ë¸ ì˜†ì— <strong>ì•„ì£¼ ì‘ì€ í•™ìŠµìš© íŒŒë¼ë¯¸í„°</strong>ë¥¼ ë¶™ì—¬ì„œ ê·¸ê²ƒë§Œ í•™ìŠµì‹œí‚¤ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.
                </p>
                <ul class="list-disc list-inside text-xs text-yellow-800 mt-2 space-y-1">
                    <li><strong>r=16</strong>: ë­í¬(Rank). ìˆ«ìê°€ í´ìˆ˜ë¡ ì„±ëŠ¥ì€ ì¢‹ì§€ë§Œ ë¬´ê±°ì›Œì§.</li>
                    <li><strong>target_modules</strong>: LoRAë¥¼ ë¶™ì¼ ìœ„ì¹˜ (GPT-2ì—ì„œëŠ” ì£¼ë¡œ Attention ëª¨ë“ˆ).</li>
                </ul>
            </div>

            <div class="code-block rounded-lg overflow-hidden my-4 shadow-lg border border-gray-800">
                <div class="flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700">
                    <span class="text-xs text-gray-400 font-mono">python</span>
                </div>
                <div class="p-4 overflow-x-auto">
<pre><code class="text-sm"># STEP 4: LoRA ì„¤ì •
lora_config = LoraConfig(
    r=<span class="code-number">16</span>,             <span class="code-comment"># LoRA Rank</span>
    lora_alpha=<span class="code-number">8</span>,     <span class="code-comment"># ìŠ¤ì¼€ì¼ë§ ê³„ìˆ˜</span>
    target_modules=[<span class="code-string">"c_attn"</span>, <span class="code-string">"c_proj"</span>, <span class="code-string">"q_attn"</span>], <span class="code-comment"># ì ìš©í•  ë ˆì´ì–´</span>
    lora_dropout=<span class="code-number">0.05</span>,
    bias=<span class="code-string">"none"</span>,
    task_type=TaskType.CAUSAL_LM,
)

# ëª¨ë¸ì— LoRA ì ìš©
model = get_peft_model(model, lora_config)

# í•™ìŠµ ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„° ìˆ˜ í™•ì¸
model.print_trainable_parameters()</code></pre>
                </div>
            </div>

            <div class="bg-gray-100 rounded-md p-4 my-4 font-mono text-xs text-gray-700 border border-gray-200 shadow-inner">
                <div class="flex items-center space-x-2 mb-2 text-gray-500 border-b border-gray-300 pb-2">
                    <i data-lucide="terminal" class="w-3 h-3"></i>
                    <span>Output Console</span>
                </div>
                <div class="whitespace-pre-wrap">trainable params: 1,622,016 || all params: 126,061,824 || trainable%: 1.2867</div>
            </div>
            <p class="text-xs text-gray-500 mt-1 pl-1">
                <i data-lucide="info" class="w-3 h-3 inline"></i> ì „ì²´ íŒŒë¼ë¯¸í„°ì˜ ì•½ 1.2%ë§Œ í•™ìŠµí•˜ë©´ ë˜ë¯€ë¡œ ë§¤ìš° íš¨ìœ¨ì ì…ë‹ˆë‹¤.
            </p>
        </section>

        <!-- Step 5-7: Data Prep -->
        <section id="data" class="mb-20 scroll-mt-24 section-container">
            <div class="flex items-center space-x-3 mb-6 border-b border-gray-200 pb-4">
                <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600">
                    <i data-lucide="database" class="w-6 h-6"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">STEP 5~7: ë°ì´í„° ì¤€ë¹„ ë° ì²˜ë¦¬</h2>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div class="bg-white p-4 rounded-lg border border-gray-200">
                    <h5 class="font-bold text-gray-800 mb-2">ë°ì´í„° ì •ì˜</h5>
                    <p class="text-sm text-gray-600">ì§ˆë¬¸ê³¼ ë‹µë³€ì´ í¬í•¨ëœ ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. ì‹¤ìŠµìš©ìœ¼ë¡œ 2ê°œë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
                </div>
                <div class="bg-white p-4 rounded-lg border border-gray-200">
                    <h5 class="font-bold text-gray-800 mb-2">ë°ì´í„° ì½œë ˆì´í„°</h5>
                    <p class="text-sm text-gray-600">GPTëŠ” ë‹¤ìŒ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì´ë¯€ë¡œ MLM(Masked Language Model)ì€ <code>False</code>ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.</p>
                </div>
            </div>

            <div class="code-block rounded-lg overflow-hidden my-4 shadow-lg border border-gray-800">
                <div class="p-4 overflow-x-auto">
<pre><code class="text-sm"># STEP 5: í•™ìŠµ ë°ì´í„°ì…‹ ì •ì˜
data = {
    <span class="code-string">"text"</span>: [
        <span class="code-string">"### ì§ˆë¬¸: ìš°ë¦¬ì§‘ ê°•ì•„ì§€ ì´ë¦„ì€?\n### ë‹µë³€: ìˆœë‘¥ì´"</span>,
        <span class="code-string">"### ì§ˆë¬¸: ë°”ë‹¤ëŠ” ì™œ íŒŒë€ê°€ìš”?\n### ë‹µë³€: í–‡ë¹›ì˜ ì‚°ë€"</span>,
    ]
}
dataset = Dataset.from_dict(data)

# STEP 6: í† í¬ë‚˜ì´ì¦ˆ í•¨ìˆ˜
def tokenize_function(example):
    <span class="code-keyword">return</span> tokenizer(example[<span class="code-string">"text"</span>], padding=<span class="code-string">"max_length"</span>, truncation=<span class="code-keyword">True</span>, max_length=<span class="code-number">128</span>)

tokenized_dataset = dataset.map(tokenize_function)

# STEP 7: ë°ì´í„° ì½œë ˆì´í„°
data_collator = DataCollatorForLanguageModeling(tokenizer=tokenizer, mlm=<span class="code-keyword">False</span>)</code></pre>
                </div>
            </div>
        </section>

        <!-- Step 8-9: Training -->
        <section id="train" class="mb-20 scroll-mt-24 section-container">
            <div class="flex items-center space-x-3 mb-6 border-b border-gray-200 pb-4">
                <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600">
                    <i data-lucide="play-circle" class="w-6 h-6"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">STEP 8~9: í•™ìŠµ ì„¤ì • ë° ì‹¤í–‰</h2>
            </div>

            <div class="bg-white border-l-4 border-indigo-500 pl-4 py-2 my-4 shadow-sm">
                <h4 class="font-bold text-gray-800 mb-2">í•™ìŠµ ë£¨í”„ ì‹¤í–‰</h4>
                <p class="text-gray-600 text-sm">
                    ë°ì´í„°ê°€ ë§¤ìš° ì ìœ¼ë¯€ë¡œ <code>num_train_epochs</code>ë¥¼ 50ìœ¼ë¡œ ì„¤ì •í•´ ë°˜ë³µ í•™ìŠµì‹œí‚µë‹ˆë‹¤. 
                    <code>compute_metrics</code> í•¨ìˆ˜ë¥¼ í†µí•´ ì •í™•ë„ê°€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
            </div>

            <div class="code-block rounded-lg overflow-hidden my-4 shadow-lg border border-gray-800">
                <div class="p-4 overflow-x-auto">
<pre><code class="text-sm"># STEP 8: íŠ¸ë ˆì´ë‹ ì„¤ì •
training_args = TrainingArguments(
    output_dir=<span class="code-string">"./results"</span>,
    per_device_train_batch_size=<span class="code-number">10</span>,
    num_train_epochs=<span class="code-number">50</span>,  <span class="code-comment"># 50ë²ˆ ë°˜ë³µ í•™ìŠµ</span>
    logging_steps=<span class="code-number">1</span>,
    save_strategy=<span class="code-string">"no"</span>,
    report_to=<span class="code-string">"none"</span>
)

<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np

# ì •í™•ë„ ê³„ì‚° í•¨ìˆ˜
def compute_metrics(eval_pred):
    logits, labels = eval_pred
    predictions = np.argmax(logits, axis=-1)
    mask = labels != -<span class="code-number">100</span>  <span class="code-comment"># íŒ¨ë”© ì œì™¸</span>
    correct = (predictions == labels) & mask
    accuracy = correct.sum() / mask.sum()
    <span class="code-keyword">return</span> {<span class="code-string">"accuracy"</span>: accuracy}

# STEP 9: íŠ¸ë ˆì´ë„ˆ ì„¤ì • ë° í•™ìŠµ ì‹œì‘
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_dataset,
    tokenizer=tokenizer,
    data_collator=data_collator,
    compute_metrics=compute_metrics
)

trainer.train()</code></pre>
                </div>
            </div>

            <div class="bg-gray-100 rounded-md p-4 my-4 font-mono text-xs text-gray-700 border border-gray-200 shadow-inner">
                <div class="flex items-center space-x-2 mb-2 text-gray-500 border-b border-gray-300 pb-2">
                    <i data-lucide="terminal" class="w-3 h-3"></i>
                    <span>Output Console (Training Log)</span>
                </div>
                <div class="whitespace-pre-wrap">
Step	Training Loss
1	3.293700
...
25	3.031400
...
50	0.080900

TrainOutput(..., train_loss=0.6964..., epoch=50.0)</div>
            </div>
            <p class="text-xs text-green-600 mt-1 pl-1 font-bold">
                <i data-lucide="trending-down" class="w-3 h-3 inline"></i> Lossê°€ 3.29ì—ì„œ 0.08ê¹Œì§€ ë–¨ì–´ì§„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
            </p>
        </section>

        <!-- Step 10: Inference -->
        <section id="predict" class="mb-20 scroll-mt-24 section-container">
            <div class="flex items-center space-x-3 mb-6 border-b border-gray-200 pb-4">
                <div class="p-2 bg-indigo-100 rounded-lg text-indigo-600">
                    <i data-lucide="message-square" class="w-6 h-6"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">STEP 10: ì¶”ë¡  (ê²°ê³¼ í™•ì¸)</h2>
            </div>

            <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-100 mb-6">
                <h4 class="font-bold text-indigo-900 mb-2">í…ŒìŠ¤íŠ¸ ì§ˆë¬¸</h4>
                <p class="text-indigo-800 text-lg">"### ì§ˆë¬¸: ìš°ë¦¬ì§‘ ê°•ì•„ì§€ ì´ë¦„ì€?\n### ë‹µë³€:"</p>
            </div>

            <div class="code-block rounded-lg overflow-hidden my-4 shadow-lg border border-gray-800">
                <div class="p-4 overflow-x-auto">
<pre><code class="text-sm"># STEP 10: ì¶”ë¡  ì˜ˆì‹œ
input_text = <span class="code-string">"### ì§ˆë¬¸: ìš°ë¦¬ì§‘ ê°•ì•„ì§€ ì´ë¦„ì€?\n### ë‹µë³€:"</span>
inputs = tokenizer(input_text, return_tensors=<span class="code-string">"pt"</span>)

# GPUë¡œ ì´ë™
device = model.device
inputs = {k: v.to(device) <span class="code-keyword">for</span> k, v <span class="code-keyword">in</span> inputs.items()}

# ìƒì„±
outputs = model.generate(**inputs, max_new_tokens=<span class="code-number">50</span>)
print(tokenizer.decode(outputs[<span class="code-number">0</span>], skip_special_tokens=<span class="code-keyword">True</span>))</code></pre>
                </div>
            </div>

            <div class="bg-gray-800 text-green-400 rounded-md p-6 my-4 font-mono shadow-lg border-l-4 border-green-500">
                <div class="flex items-center space-x-2 mb-4 border-b border-gray-700 pb-2 text-gray-400">
                    <i data-lucide="check-circle" class="w-4 h-4"></i>
                    <span class="text-sm">Execution Result</span>
                </div>
                <div class="text-lg whitespace-pre-wrap">### ì§ˆë¬¸: ìš°ë¦¬ì§‘ ê°•ì•„ì§€ ì´ë¦„ì€?
### ë‹µë³€: ìˆœë‘¥ì´</div>
            </div>

            <div class="mt-8 p-6 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl text-white shadow-lg text-center">
                <h3 class="text-xl font-bold mb-2">ğŸ‰ íŒŒì¸íŠœë‹ ì„±ê³µ!</h3>
                <p class="text-indigo-100 mb-4">
                    ëª¨ë¸ì´ í•™ìŠµ ë°ì´í„°ì— ìˆëŠ” "ìˆœë‘¥ì´"ë¼ëŠ” ë‹µë³€ì„ ì •í™•í•˜ê²Œ ìƒì„±í•´ëƒˆìŠµë‹ˆë‹¤.
                </p>
                <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="px-6 py-2 bg-white text-indigo-600 font-bold rounded-full shadow hover:bg-gray-100 transition-colors">
                    ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°
                </button>
            </div>
        </section>

    </main>

    <script>
        // Use an IIFE with event listener to ensure DOM content is loaded
        (function() {
            // Wait for DOMContentLoaded to handle scripts that rely on DOM elements
            document.addEventListener("DOMContentLoaded", function() {
                // Initialize Lucide icons if available
                if (typeof lucide !== 'undefined' && lucide.createIcons) {
                    lucide.createIcons();
                }

                // Navigation Data
                const sections = [
                    { id: 'intro', title: 'ì‹¤ìŠµ ì†Œê°œ', icon: 'book-open' },
                    { id: 'setup', title: 'í™˜ê²½ ì„¤ì •', icon: 'settings' },
                    { id: 'model', title: 'ëª¨ë¸ ë¡œë“œ', icon: 'brain' },
                    { id: 'lora', title: 'LoRA ì„¤ì •', icon: 'layers' },
                    { id: 'data', title: 'ë°ì´í„° ì¤€ë¹„', icon: 'database' },
                    { id: 'train', title: 'í•™ìŠµ ì‹¤í–‰', icon: 'play-circle' },
                    { id: 'predict', title: 'ê²°ê³¼ í™•ì¸', icon: 'message-square' },
                ];

                const desktopNav = document.getElementById('desktop-nav');
                const mobileNavItems = document.getElementById('mobile-nav-items');
                const mobileMenuBtn = document.getElementById('mobile-menu-btn');
                const mobileMenu = document.getElementById('mobile-menu');

                // Render Nav Items
                sections.forEach(section => {
                    // Desktop
                    const btn = document.createElement('button');
                    btn.className = 'nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-colors';
                    btn.innerText = section.title;
                    btn.dataset.target = section.id;
                    btn.onclick = () => scrollToSection(section.id);
                    desktopNav.appendChild(btn);

                    // Mobile
                    const mBtn = document.createElement('button');
                    mBtn.className = 'block w-full text-left px-3 py-4 rounded-md text-base font-medium text-gray-600 hover:bg-gray-100 hover:text-gray-900';
                    mBtn.innerHTML = `<div class="flex items-center"><i data-lucide="${section.icon}" class="mr-3 w-4 h-4"></i>${section.title}</div>`;
                    mBtn.onclick = () => {
                        scrollToSection(section.id);
                        mobileMenu.classList.add('hidden');
                    };
                    mobileNavItems.appendChild(mBtn);
                });

                // Re-init icons for dynamic content if lucide is available
                if (typeof lucide !== 'undefined' && lucide.createIcons) {
                    lucide.createIcons();
                }

                // Mobile Menu Toggle
                mobileMenuBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });

                // Scroll Spy
                window.addEventListener('scroll', () => {
                    const scrollPosition = window.scrollY + 100;
                    const navLinks = document.querySelectorAll('.nav-link');

                    sections.forEach(section => {
                        const element = document.getElementById(section.id);
                        if (element) {
                            const { offsetTop, offsetHeight } = element;
                            if (scrollPosition >= offsetTop && scrollPosition < offsetTop + offsetHeight) {
                                navLinks.forEach(link => {
                                    if (link.dataset.target === section.id) {
                                        link.classList.add('bg-indigo-50', 'text-indigo-700');
                                        link.classList.remove('text-gray-600');
                                    } else {
                                        link.classList.remove('bg-indigo-50', 'text-indigo-700');
                                        link.classList.add('text-gray-600');
                                    }
                                });
                            }
                        }
                    });
                });
            });

            // Scroll Handling (Defined globally so inline onclicks work, but safe to attach to window)
            window.scrollToSection = function(id) {
                const element = document.getElementById(id);
                if (element) {
                    const offset = 80; // height of nav
                    const bodyRect = document.body.getBoundingClientRect().top;
                    const elementRect = element.getBoundingClientRect().top;
                    const elementPosition = elementRect - bodyRect;
                    const offsetPosition = elementPosition - offset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            }
        })();
    </script>
</body>
</html>