<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>07. ë‹¤ì¤‘ë¶„ë¥˜_MNIST (ì´ˆë³´ì ê°€ì´ë“œ í¬í•¨)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <style>
        body {
            background-color: #f3f4f6;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #1f2937;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 40px;
            overflow: hidden;
            border: 1px solid #e5e7eb;
        }
        .card-header {
            background: #f9fafb;
            padding: 16px 24px;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-body {
            padding: 24px;
        }
        .markdown-content h1 { font-size: 2rem; font-weight: 800; margin-bottom: 1rem; color: #111827; }
        .markdown-content h2 { font-size: 1.5rem; font-weight: 700; margin-top: 1.5rem; margin-bottom: 1rem; color: #374151; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem; }
        .markdown-content h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.2rem; margin-bottom: 0.8rem; color: #4b5563; }
        .markdown-content p { margin-bottom: 1rem; }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
        
        pre {
            margin: 0 !important;
            border-radius: 8px !important;
            font-size: 0.9rem !important;
        }
        
        .output-area {
            background-color: #2d2d2d;
            color: #e0e0e0;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            border-left: 4px solid #10b981;
        }
        
        .badge {
            display: inline-block;
            padding: 2px 8px;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 9999px;
            background-color: #dbeafe;
            color: #1e40af;
            margin-right: 8px;
        }

        .fill-in {
            border: 2px dashed #f59e0b;
            background-color: #fffbeb;
        }
        .fill-in-badge {
            background-color: #fef3c7;
            color: #92400e;
        }

        /* Tip Box Style */
        .tip-box {
            background-color: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 16px;
            margin: 16px 0;
            border-radius: 4px;
        }
        .tip-title {
            font-weight: bold;
            color: #0369a1;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        html {
            scroll-behavior: smooth;
        }
        .section-marker {
            scroll-margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">

    <!-- Header -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">07. ë‹¤ì¤‘ë¶„ë¥˜ MNIST (ì´ˆë³´ì ê°€ì´ë“œ)</h1>
        <p class="text-lg text-gray-600">Kerasë¥¼ í™œìš©í•œ ì†ê¸€ì”¨ ìˆ«ì ë¶„ë¥˜ ëª¨ë¸ë§ í•™ìŠµ ë…¸íŠ¸ì…ë‹ˆë‹¤.<br>ì´ˆë³´ìë¥¼ ìœ„í•œ ìƒì„¸í•œ ì„¤ëª…ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
    </div>

    <!-- Section: Intro -->
    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h1>ë‹¤ì¤‘ë¶„ë¥˜_MNIST ì‹œì‘í•˜ê¸°</h1>
            <p>ì´ ì‹¤ìŠµì—ì„œëŠ” <strong>0ë¶€í„° 9ê¹Œì§€ì˜ ì†ê¸€ì”¨ ìˆ«ì ì´ë¯¸ì§€(MNIST ë°ì´í„°ì…‹)</strong>ë¥¼ ì»´í“¨í„°ê°€ ì¸ì‹í•˜ë„ë¡ í•™ìŠµì‹œí‚¤ëŠ” ì¸ê³µì§€ëŠ¥ ëª¨ë¸ì„ ë§Œë“­ë‹ˆë‹¤.</p>
            <div class="tip-box">
                <div class="tip-title">ğŸ’¡ ë‹¤ì¤‘ ë¶„ë¥˜(Multi-class Classification)ë€?</div>
                <p>ì •ë‹µ(Class)ì´ 3ê°œ ì´ìƒì¸ ë¬¸ì œë¥¼ ë§í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ì •ë‹µì´ 0~9ê¹Œì§€ ì´ 10ê°œì´ë¯€ë¡œ ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œì…ë‹ˆë‹¤. (ì°¸ê³ : ì •ë‹µì´ O/X ì²˜ëŸ¼ 2ê°œë©´ ì´ì§„ ë¶„ë¥˜ë¼ê³  í•©ë‹ˆë‹¤.)</p>
            </div>
        </div>
    </div>

    <!-- Section 1. í™˜ê²½ì¤€ë¹„ -->
    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h2>1. í™˜ê²½ì¤€ë¹„</h2>
            <h3>(1) ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”©</h3>
            <p>ë°ì´í„° ë¶„ì„ê³¼ ë”¥ëŸ¬ë‹ ëª¨ë¸ë§ì— í•„ìš”í•œ ë„êµ¬ë“¤ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- Code Cell -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸
        </div>
        <div class="card-body">
            <pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.model_selection import train_test_split
from sklearn.metrics import *
from sklearn.preprocessing import StandardScaler, MinMaxScaler

# ë”¥ëŸ¬ë‹ ëª¨ë¸ë§ì„ ìœ„í•œ ì¼€ë¼ìŠ¤(Keras) ë¼ì´ë¸ŒëŸ¬ë¦¬
from keras.models import Sequential
from keras.layers import Dense, Flatten, Input
from keras.backend import clear_session
from keras.optimizers import Adam
from keras.datasets import mnist, fashion_mnist</code></pre>
            <div class="tip-box">
                <div class="tip-title">ğŸ“š ì´ˆë³´ì ì‚¬ì „</div>
                <ul class="list-disc pl-5 mt-2 space-y-1">
                    <li><strong>Sequential</strong>: ë¸”ë¡ì„ ìŒ“ë“¯ì´ ì¸µ(Layer)ì„ ìˆœì„œëŒ€ë¡œ ìŒ“ì•„ ë§Œë“œëŠ” ëª¨ë¸ì…ë‹ˆë‹¤.</li>
                    <li><strong>Dense</strong>: ê°€ì¥ ê¸°ë³¸ì ì¸ ì‹ ê²½ë§ ì¸µì…ë‹ˆë‹¤. ëª¨ë“  ë‰´ëŸ°ì´ ì„œë¡œ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
                    <li><strong>Adam</strong>: ëª¨ë¸ì´ ì •ë‹µì„ ì˜ ì°¾ë„ë¡ í•™ìŠµ ì†ë„ì™€ ë°©í–¥ì„ ì¡°ì ˆí•´ì£¼ëŠ” ìµœì í™” ë„êµ¬(Optimizer)ì…ë‹ˆë‹¤. ê°€ì¥ ë„ë¦¬ ì“°ì…ë‹ˆë‹¤.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Code Cell: Functions -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> í•™ìŠµ ê³¡ì„  ê·¸ë˜í”„ í•¨ìˆ˜
        </div>
        <div class="card-body">
            <p class="mb-2 text-sm text-gray-600">ëª¨ë¸ì´ ê³µë¶€(í•™ìŠµ)ë¥¼ ì˜ í•˜ê³  ìˆëŠ”ì§€ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•´ ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.</p>
            <pre><code class="language-python"># í•™ìŠµê³¡ì„  ê·¸ë¦¬ê¸° í•¨ìˆ˜
def dl_history_plot(history):
    plt.figure(figsize=(10,6))
    plt.plot(history['loss'], label='train_err')
    plt.plot(history['val_loss'], label='val_err')

    plt.ylabel('Loss')
    plt.xlabel('Epoch')
    plt.legend()
    plt.grid()
    plt.show()</code></pre>
        </div>
    </div>

    <!-- Section: Data Loading -->
    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h3>(2) ë°ì´í„° ë¡œë”©</h3>
            <p>Kerasì—ì„œ ì œê³µí•˜ëŠ” <code>mnist</code> ë°ì´í„°ì…‹ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤. ì´ë¯¸ í›ˆë ¨ìš©(train)ê³¼ ê²€ì¦ìš©(val)ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- Code Cell: Load Data -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        </div>
        <div class="card-body">
            <pre><code class="language-python"># ì¼€ë¼ìŠ¤ ë°ì´í„°ì…‹ìœ¼ë¡œ ë¶€í„° mnist ë¶ˆëŸ¬ì˜¤ê¸°
(x_train, y_train), (x_val, y_val) = mnist.load_data()</code></pre>
            <div class="output-area">Downloading data...
11490434/11490434 [==============================] - 2s 0us/step</div>
        </div>
    </div>

    <!-- Code Cell: Check Shape -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ë°ì´í„° í˜•íƒœ(Shape) í™•ì¸
        </div>
        <div class="card-body">
            <pre><code class="language-python">x_train.shape, y_train.shape</code></pre>
            <div class="output-area">((60000, 28, 28), (60000,))</div>
            <div class="tip-box">
                <div class="tip-title">ğŸ‘€ í•´ì„</div>
                <p><code>(60000, 28, 28)</code>: 28x28 í”½ì…€ í¬ê¸°ì˜ ì´ë¯¸ì§€ê°€ 60,000ì¥ ìˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <!-- Code Cell: Class Names -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> í´ë˜ìŠ¤ ì´ë¦„ ì •ì˜
        </div>
        <div class="card-body">
            <pre><code class="language-python">class_names = ['0','1','2','3','4','5','6','7','8','9']</code></pre>
        </div>
    </div>

    <!-- Section 2. ë°ì´í„° ì‚´í´ë³´ê¸° -->
    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h2>2. ë°ì´í„° ì‚´í´ë³´ê¸°</h2>
            <p>ì‹¤ì œ ì´ë¯¸ì§€ê°€ ì–´ë–»ê²Œ ìƒê²¼ëŠ”ì§€ ëˆˆìœ¼ë¡œ í™•ì¸í•´ë³´ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- Code Cell: Visualize Single Image -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ì´ë¯¸ì§€ 1ì¥ í™•ì¸í•´ë³´ê¸°
        </div>
        <div class="card-body">
            <pre><code class="language-python">n = 12229 # í™•ì¸í•˜ê³  ì‹¶ì€ ë°ì´í„° ë²ˆí˜¸

print(y_train[n]) # ì‹¤ì œ ì •ë‹µ(ìˆ«ì) ì¶œë ¥
plt.figure()
plt.imshow(x_train[n], cmap=plt.cm.binary) # ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
plt.colorbar()
plt.show()</code></pre>
            <div class="output-area">5
<Figure size 640x480 with 2 Axes></div>
        </div>
    </div>

    <!-- Code Cell: Visualize Multiple Images -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ì—¬ëŸ¬ ì´ë¯¸ì§€ í•œëˆˆì— ë³´ê¸°
        </div>
        <div class="card-body">
            <pre><code class="language-python">plt.figure(figsize=(10,10))
for i in range(25): # 25ê°œë§Œ ì¶œë ¥
    plt.subplot(5,5,i+1)
    plt.xticks([])
    plt.yticks([])
    plt.imshow(x_train[i], cmap=plt.cm.binary)
    plt.xlabel(class_names[y_train[i]])
plt.tight_layout()
plt.show()</code></pre>
            <div class="output-area"><Figure size 1000x1000 with 25 Axes></div>
        </div>
    </div>

    <!-- Section 3. ë°ì´í„° ì¤€ë¹„ -->
    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h2>3. ë°ì´í„° ì¤€ë¹„ (ì „ì²˜ë¦¬)</h2>
            <h3>(1) ë°ì´í„° 2ì°¨ì›ìœ¼ë¡œ í¼ì¹˜ê¸° (Flatten)</h3>
            <p>ìš°ë¦¬ê°€ ì‚¬ìš©í•  ê¸°ë³¸ ë”¥ëŸ¬ë‹ ëª¨ë¸(Dense Layer)ì€ 2ì°¨ì› ì´ë¯¸ì§€(28x28 ì‚¬ê°í˜•)ë¥¼ í•œ ë²ˆì— ì´í•´í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ <strong>1ì¤„ì§œë¦¬ ê¸´ ë°ì´í„°(1ì°¨ì›, 784ê°œ ìˆ«ì)</strong>ë¡œ í´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- Code Cell: Reshape -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ë°ì´í„° ëª¨ì–‘ ë°”ê¾¸ê¸° (Reshape)
        </div>
        <div class="card-body">
            <pre><code class="language-python"># 28 * 28 = 784 í”½ì…€
x_train = x_train.reshape(60000, -1) # -1ì€ ë‚¨ì€ ì°¨ì›ì„ ìë™ìœ¼ë¡œ ê³„ì‚°í•˜ë¼ëŠ” ëœ»
x_val = x_val.reshape(10000, -1)

print(x_train.shape, x_val.shape)</code></pre>
            <div class="output-area">((60000, 784), (10000, 784))</div>
        </div>
    </div>

    <!-- Section: Scaling -->
    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h3>(2) ìŠ¤ì¼€ì¼ë§ (Scaling) : Min-Max</h3>
            <p>ì´ë¯¸ì§€ ë°ì´í„°ëŠ” 0(ê²€ì€ìƒ‰)ë¶€í„° 255(í°ìƒ‰)ê¹Œì§€ì˜ ìˆ«ìë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì»´í“¨í„°ëŠ” ìˆ«ìê°€ í¬ë©´ ê³„ì‚°ì´ ëŠë ¤ì§€ê±°ë‚˜ í•™ìŠµì´ ì˜ ì•ˆ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ <strong>0ê³¼ 1 ì‚¬ì´ì˜ ì†Œìˆ˜</strong>ë¡œ ë°”ê¿”ì¤ë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- Code Cell: Scaling -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> 0~1 ì‚¬ì´ ê°’ìœ¼ë¡œ ë‚˜ëˆ„ê¸°
        </div>
        <div class="card-body">
            <pre><code class="language-python"># ìµœëŒ€ê°’ì¸ 255ë¡œ ë‚˜ëˆ„ì–´ ì¤ë‹ˆë‹¤.
x_train = x_train / 255.
x_val = x_val / 255.</code></pre>
        </div>
    </div>

    <!-- Section 4. ëª¨ë¸ë§ -->
    <div class="card section-marker">
        <div class="card-body markdown-content">
            <h2>4. ëª¨ë¸ë§</h2>
            <p>ê°€ì¥ ë‹¨ìˆœí•œ í˜•íƒœì˜ ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ ë§Œë“¤ì–´ ë´…ë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- Code Cell: Features Check -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ì…ë ¥ ë°ì´í„° ê°œìˆ˜ í™•ì¸
        </div>
        <div class="card-body">
            <pre><code class="language-python">nfeatures = x_train.shape[1] # 784ê°œ
print(nfeatures)</code></pre>
            <div class="output-area">784</div>
        </div>
    </div>

    <!-- Code Cell: Model 1 Define -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ëª¨ë¸ 1 ì„¤ê³„ (ë‹¨ì¼ ì¸µ)
        </div>
        <div class="card-body">
            <pre><code class="language-python">clear_session() # ê¸°ì¡´ ë©”ëª¨ë¦¬ ì •ë¦¬

model = Sequential([
    # Input: 784ê°œì˜ ìˆ«ìê°€ ë“¤ì–´ì˜´ì„ ì•Œë ¤ì¤ë‹ˆë‹¤.
    Input(shape = (nfeatures,)),
    
    # Output Layer: ì •ë‹µì´ 0~9ê¹Œì§€ 10ê°œì´ë¯€ë¡œ ë…¸ë“œëŠ” 10ê°œì…ë‹ˆë‹¤.
    # activation='softmax': 10ê°œ ì¤‘ í™•ë¥ ì´ ê°€ì¥ ë†’ì€ í•˜ë‚˜ë¥¼ ê³ ë¥´ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.
    Dense(10, activation = 'softmax')
])

model.summary() # ëª¨ë¸ êµ¬ì¡° ìš”ì•½ ë³´ê¸°</code></pre>
            <div class="output-area">Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 10)                7850      
=================================================================
Total params: 7,850
Trainable params: 7,850</div>
        </div>
    </div>

    <!-- Code Cell: Compile & Fit -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> í•™ìŠµ ì„¤ì • ë° ì‹œì‘ (Compile & Fit)
        </div>
        <div class="card-body">
            <pre><code class="language-python"># ì»´íŒŒì¼: í•™ìŠµ ë°©ë²• ì„¤ì •
# loss='sparse_categorical_crossentropy': ì •ë‹µì´ 0, 1, 2 ê°™ì€ ì •ìˆ˜ì¼ ë•Œ ì‚¬ìš©í•˜ëŠ” ì˜¤ì°¨ ê³„ì‚°ë²•
model.compile(optimizer=Adam(learning_rate=0.001), loss= 'sparse_categorical_crossentropy')

# í•™ìŠµ ì‹œì‘
# epochs=20: ë¬¸ì œì§‘ì„ 20ë²ˆ ë°˜ë³µí•´ì„œ í’‰ë‹ˆë‹¤.
history = model.fit(x_train, y_train, epochs = 20, validation_split=0.2).history</code></pre>
            <div class="output-area">Epoch 1/20
...
Epoch 20/20
1500/1500 [==============================] - 4s 2ms/step - loss: 0.2444 - val_loss: 0.2640</div>
        </div>
    </div>

    <!-- Code Cell: Learning Curve -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> í•™ìŠµ ê²°ê³¼ ê·¸ë˜í”„ í™•ì¸
        </div>
        <div class="card-body">
            <p class="text-sm text-gray-600 mb-2">ê·¸ë˜í”„ê°€ ì•„ë˜ë¡œ ë‚´ë ¤ê°ˆìˆ˜ë¡ ì˜¤ì°¨(Loss)ê°€ ì¤„ì–´ë“¤ì–´ í•™ìŠµì´ ì˜ ë˜ì—ˆë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p>
            <pre><code class="language-python">dl_history_plot(history)</code></pre>
            <div class="output-area">[í•™ìŠµ ê³¡ì„  ê·¸ë˜í”„ ì¶œë ¥]</div>
        </div>
    </div>

    <!-- Code Cell: Predict -->
    <div class="card section-marker">
        <div class="card-header">
            <span class="badge">Code</span> ëª¨ë¸ ì„±ëŠ¥ í‰ê°€
        </div>
        <div class="card-body">
            <pre><code class="language-python">pred = model.predict(x_val) # ì˜ˆì¸¡í•˜ê¸°
pred_1 = pred.argmax(axis=1) # í™•ë¥  ì¤‘ ê°€ì¥ ë†’ì€ ê°’ì˜ ë²ˆí˜¸(0~9) ì°¾ê¸°

# ì •ë‹µ(y_val)ê³¼ ì˜ˆì¸¡ê°’(pred_1) ë¹„êµ
print(confusion_matrix(y_val, pred_1))
print(classification_report(y_val, pred_1, digits = 4))</code></pre>
            <div class="output-area">    accuracy                         0.9264     10000
   macro avg     0.9261    0.9253    0.9253     10000
weighted avg     0.9268    0.9264    0.9263     10000</div>
            <div class="tip-box">
                <div class="tip-title">ğŸ” ê²°ê³¼ ë¶„ì„</div>
                <p><strong>accuracy(ì •í™•ë„): 0.9264</strong> <br> ì•½ 92.6%ì˜ ì •ë‹µë¥ ì„ ë³´ì…ë‹ˆë‹¤. ë‹¨ìˆœí•œ ëª¨ë¸ì¹˜ê³  ë‚˜ì˜ì§€ ì•Šì§€ë§Œ, ë” ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
            </div>
        </div>
    </div>

    <!-- Section 5. ì‹¤ìŠµ (ëª¨ë¸ 2) -->
    <div class="card section-marker fill-in">
        <div class="card-body markdown-content">
            <h2>5. ì‹¤ìŠµ : ë” ë˜‘ë˜‘í•œ ëª¨ë¸ ë§Œë“¤ê¸° (Hidden Layer ì¶”ê°€)</h2>
            <p>ìœ„ì—ì„œëŠ” ì¸µì´ í•˜ë‚˜ë¿ì¸ ë‹¨ìˆœí•œ ëª¨ë¸ì´ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ì¤‘ê°„ì— <strong>ì€ë‹‰ì¸µ(Hidden Layer)</strong>ì„ ì¶”ê°€í•˜ì—¬ ë” ë³µì¡í•œ íŒ¨í„´ì„ í•™ìŠµí•  ìˆ˜ ìˆê²Œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.</p>
            <ul class="list-disc pl-5 text-sm text-gray-700">
                <li>ì…ë ¥ì¸µê³¼ ì¶œë ¥ì¸µ ì‚¬ì´ì— <code>Dense</code> ë ˆì´ì–´ë¥¼ í•˜ë‚˜ ë” ë¼ì›Œ ë„£ìŠµë‹ˆë‹¤.</li>
                <li><code>activation='relu'</code>: ì€ë‹‰ì¸µì—ì„œ ê°€ì¥ ë§ì´ ì“°ì´ëŠ” í™œì„±í™” í•¨ìˆ˜ì…ë‹ˆë‹¤. ì„±ëŠ¥ í–¥ìƒì— ë„ì›€ì„ ì¤ë‹ˆë‹¤.</li>
            </ul>
        </div>
    </div>

    <!-- Code Cell: Model 2 Define -->
    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">ì‹¤ìŠµ ì™„ì„±</span> ëª¨ë¸ 2 ì„¤ê³„ (Deep Learning)
        </div>
        <div class="card-body">
            <pre><code class="language-python">clear_session()

# ì€ë‹‰ì¸µ(Hidden Layer)ì„ ì¶”ê°€í•œ ëª¨ë¸
model2 = Sequential([
    Input(shape = (nfeatures,)),
    
    # [ì¶”ê°€ëœ ì¸µ] 128ê°œì˜ ë‰´ëŸ°ì„ ê°€ì§„ ì€ë‹‰ì¸µ
    # relu: í•™ìŠµ íš¨ìœ¨ì´ ì¢‹ì€ í™œì„±í™” í•¨ìˆ˜
    Dense(128, activation='relu'),
    
    # ì¶œë ¥ì¸µì€ ê·¸ëŒ€ë¡œ 10ê°œ (0~9 ë¶„ë¥˜)
    Dense(10, activation = 'softmax')
])

model2.summary()</code></pre>
            <div class="output-area">Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_1 (Dense)             (None, 128)               100480    
 dense_2 (Dense)             (None, 10)                1290      
=================================================================
Total params: 101,770
Trainable params: 101,770</div>
        </div>
    </div>

    <!-- Code Cell: Model 2 Compile & Fit (Filled) -->
    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">ì‹¤ìŠµ ì™„ì„±</span> ëª¨ë¸ 2 í•™ìŠµ
        </div>
        <div class="card-body">
            <pre><code class="language-python"># ì»´íŒŒì¼: í•™ìŠµ ë„êµ¬ ì„¤ì •
model2.compile(optimizer=Adam(learning_rate=0.001), loss = 'sparse_categorical_crossentropy')

# í•™ìŠµ: 10ë²ˆ ë°˜ë³µ (Epochs 10)
hist2 = model2.fit(x_train, y_train, epochs = 10, validation_split=.2).history</code></pre>
            <div class="output-area">Epoch 1/10
1500/1500 [==============================] - 7s 3ms/step - loss: 0.4786 - val_loss: 0.1563
...
Epoch 10/10
1500/1500 [==============================] - 5s 2ms/step - loss: 0.0148 - val_loss: 0.0956</div>
        </div>
    </div>

    <!-- Code Cell: Model 2 Plot (Filled) -->
    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">ì‹¤ìŠµ ì™„ì„±</span> í•™ìŠµ ê²°ê³¼ ê·¸ë˜í”„
        </div>
        <div class="card-body">
            <pre><code class="language-python"># ì˜¤ì°¨ê°€ ì–¼ë§ˆë‚˜ ì¤„ì—ˆëŠ”ì§€ í™•ì¸
dl_history_plot(hist2)</code></pre>
            <div class="output-area">[ê·¸ë˜í”„ë¥¼ ë³´ë©´ ëª¨ë¸1ë³´ë‹¤ Lossê°€ í›¨ì”¬ ë” ë‚®ê²Œ, ë¹ ë¥´ê²Œ ë–¨ì–´ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.]</div>
        </div>
    </div>

    <!-- Code Cell: Model 2 Evaluation (Filled) -->
    <div class="card section-marker fill-in">
        <div class="card-header">
            <span class="badge fill-in-badge">ì‹¤ìŠµ ì™„ì„±</span> ìµœì¢… ì„±ëŠ¥ í‰ê°€
        </div>
        <div class="card-body">
            <pre><code class="language-python"># ì˜ˆì¸¡í•˜ê¸°
pred2 = model2.predict(x_val)
pred_2 = pred2.argmax(axis=1)

# ì„±ëŠ¥í‘œ ì¶œë ¥
print(confusion_matrix(y_val, pred_2))
print("-" * 60)
print(classification_report(y_val, pred_2, digits = 4))</code></pre>
            <div class="output-area">[[ 971    1    1    2    1    1    0    1    1    1]
 [   0 1124    2    2    0    1    3    1    2    0]
 ...
    accuracy                         0.9763     10000
   macro avg     0.9765    0.9762    0.9762     10000
weighted avg     0.9766    0.9763    0.9763     10000</div>
            <div class="tip-box">
                <div class="tip-title">ğŸ‰ ê²°ë¡ </div>
                <p><strong>accuracy(ì •í™•ë„): 0.9763</strong> <br> ì€ë‹‰ì¸µì„ í•˜ë‚˜ ì¶”ê°€í–ˆì„ ë¿ì¸ë° ì •í™•ë„ê°€ <strong>ì•½ 92% â†’ 97.6%</strong>ë¡œ í¬ê²Œ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤! ì¸µì„ ê¹Šê²Œ ìŒ“ì„ìˆ˜ë¡(Deep Learning) ëª¨ë¸ì´ ë” ë³µì¡í•œ íŠ¹ì§•ì„ ì˜ í•™ìŠµí•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <div class="text-center mt-12 mb-20">
        <p class="text-gray-500">ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤! ì´ì œ ì—¬ëŸ¬ë¶„ì€ ë”¥ëŸ¬ë‹ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ë¶„ë¥˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</body>
</html>